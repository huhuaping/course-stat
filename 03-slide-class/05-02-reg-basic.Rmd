---
params:
  hideslide: TRUE
output:
  xaringan::moon_reader:
    seal: false
    lib_dir: libs
    css:
      - default
      - ../mycss/my-theme.css 
      - ../mycss/my-font.css
      - ../mycss/my-custom-for-video-roomy.css
      - ../mycss/text-box.css
      - duke-blue
      - hygge-duke
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
---
background-image: url("../pic/slide-front-page.jpg")
class: center,middle
exclude: `r params$hideslide`

# ç»Ÿè®¡å­¦åŸç†(Statistic)

<!---    chakra: libs/remark-latest.min.js --->

### èƒ¡åå¹³

### è¥¿åŒ—å†œæ—ç§‘æŠ€å¤§å­¦

### ç»æµç®¡ç†å­¦é™¢æ•°é‡ç»æµæ•™ç ”å®¤

### huhuaping01@hotmail.com

### `r Sys.Date()`

```{r , echo=F,message=FALSE,warning=F, eval=!params$hideslide}
source("../R/set-global.R")
source("../R/xfun.R", encoding = "UTF-8")
source("../R/external-math-equation.R")
options(width = 70)
#source("../R/xaringan-chromote-print.R")
```


```{r , echo=FALSE, eval=!params$hideslide}
require('xaringanExtra')

xaringanExtra::use_tachyons()

xaringanExtra::use_panelset()

xaringanExtra::use_logo(
  image_url = "../pic/logo/nwafu-logo-circle-wb.png",
  height = '70px',
  position = xaringanExtra::css_position(top='0.2em',left="1em")
)
```

---
class: center, middle, duke-orange,hide_logo
name: chapter
exclude: `r params$hideslide`

# ç¬¬äº”ç«  ç›¸å…³å’Œå›å½’åˆ†æ


### [5.1 å˜é‡é—´å…³ç³»çš„åº¦é‡](#corl)

### [5.2 å›å½’åˆ†æçš„åŸºæœ¬æ€æƒ³](#concept)

### [5.3 OLSæ–¹æ³•ä¸å‚æ•°ä¼°è®¡](#ols)

### [5.4 å‡è®¾æ£€éªŒ](#hypthesis)

### [5.5 æ‹Ÿåˆä¼˜åº¦ä¸æ®‹å·®åˆ†æ](#goodness)

### [5.6 å›å½’é¢„æµ‹åˆ†æ](#forecast)

### [5.7 å›å½’æŠ¥å‘Šè§£è¯»](#report)

---
layout: false
class: center, middle, duke-softblue,hide_logo
name: concept

# 5.2 å›å½’åˆ†æçš„åŸºæœ¬æ€æƒ³

### [ç›¸å…³å…³ç³»VSå› æœå…³ç³»](#basic-vs)

### [é‡è¦æ¦‚å¿µ](#basic-important)


---
layout: true

<div class="my-header-h2"></div>

<div class="watermark1"></div>

<div class="watermark2"></div>

<div class="watermark3"></div>

<div class="my-footer"><span>huhuaping@  &emsp;&emsp; <a href="#chapter"> ç¬¬05ç«  ç›¸å…³å’Œå›å½’åˆ†æ </a>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
<a href="#concept"> 5.2 å›å½’åˆ†æçš„åŸºæœ¬æ€æƒ³ </a> </span></div> 

---

## çº¿æ€§å›å½’åˆ†æ

ä»ä¸€ç»„æ ·æœ¬æ•°æ®å‡ºå‘ï¼Œç¡®å®šå˜é‡ä¹‹é—´çš„æ•°å­¦å…³ç³»å¼ã€‚

å¯¹è¿™äº›å…³ç³»å¼çš„å¯ä¿¡ç¨‹åº¦è¿›è¡Œå„ç§ç»Ÿè®¡æ£€éªŒï¼Œå¹¶ä»å½±å“æŸä¸€ç‰¹å®šå˜é‡çš„è¯¸å¤šå˜é‡ä¸­æ‰¾å‡ºå“ªäº›å˜é‡çš„å½±å“æ˜¾è‘—ï¼Œå“ªäº›ä¸æ˜¾è‘—ã€‚

åˆ©ç”¨æ‰€æ±‚çš„å…³ç³»å¼ï¼Œæ ¹æ®ä¸€ä¸ªæˆ–å‡ ä¸ªå˜é‡çš„å–å€¼æ¥é¢„æµ‹æˆ–æ§åˆ¶å¦ä¸€ä¸ªç‰¹å®šå˜é‡çš„å–å€¼ï¼Œå¹¶ç»™å‡ºè¿™ç§é¢„æµ‹æˆ–æ§åˆ¶çš„ç²¾ç¡®ç¨‹åº¦ã€‚


---

name: basic-vs

## ç›¸å…³å…³ç³»ï¼šè¾¹é™…ç›¸å…³ä¸æ¡ä»¶ç›¸å…³1

```{r, out.width= "90%", fig.cap="è¾¹é™…ç›¸å…³ä½†æ˜¯æ¡ä»¶ç‹¬ç«‹"}
include_graphics("../pic/chpt05-causality-margin.png")
```

---

## ç›¸å…³å…³ç³»ï¼šè¾¹é™…ç›¸å…³ä¸æ¡ä»¶ç›¸å…³2

```{r, out.width= "90%", fig.cap="è¾¹é™…ç‹¬ç«‹ä½†æ˜¯æ¡ä»¶ç›¸å…³"}
include_graphics("../pic/chpt05-causality-margin-2.png")
```

---

## ç›¸å…³å…³ç³»VSå› æœå…³ç³»


```{r, out.width= "60%", fig.cap="å·§å…‹åŠ›æ¶ˆè´¹é‡ä¸è¯ºè´å°”å¥–æ•°é‡"}
include_graphics("../pic/chpt05-causality-chocolate.png")
```

---

## ç›¸å…³å…³ç³»VSå› æœå…³ç³»ï¼šæ€§åˆ«çš„ä½œç”¨

```{r, out.width= "95%", fig.cap="æ²»ç–—åº·å¤è¡¨"}
include_graphics("../pic/chpt05-causality-drug-gender1.png")
```

```{r, out.width= "60%", fig.cap="å› æœå…³ç³»å›¾"}
include_graphics("../pic/chpt05-causality-drug-gender-graph1.png")
```

---

## ç›¸å…³å…³ç³»VSå› æœå…³ç³»ï¼šè¡€å‹çš„ä½œç”¨

```{r, out.width= "100%", fig.cap="æ²»ç–—åº·å¤è¡¨"}
include_graphics("../pic/chpt05-causality-drug-pressure-tab.png")
```

```{r, out.width= "60%", fig.cap="å› æœå…³ç³»å›¾"}
include_graphics("../pic/chpt05-causality-drug-pressure-graph.png")
```

---
exclude: true

## ï¼ˆæ¡ˆä¾‹ï¼‰å¾®å‹å®¶åº­æ€»ä½“

<!---æ–°æ•°æ®è¡¨--->

```{r}
source("Rscript/case-familiy60.R", 
       encoding = "UTF-8")
```


---

### ï¼ˆæ¡ˆä¾‹ï¼‰å‡æƒ³æ€»ä½“ï¼š60ä¸ªå®¶åº­çš„æ”¶æ”¯æ•°æ®ï¼ˆç›´è§‚åˆ—è¡¨ï¼‰


```{r, fig.cap="60ä¸ªå®¶åº­çš„æ”¶å…¥å’Œæ”¯å‡ºæƒ…å†µï¼šå‡è®¾çš„æ€»ä½“"}
include_graphics("../pic/extra/chpt2-1-60families-pop.png",dpi=150)
```

???
æé—®ï¼š

- æ€»ä½“æ˜¯ä»€ä¹ˆï¼Ÿ

- æœ‰å¤šå°‘æ€»ä½“å•ä½ï¼Ÿ

---

### ï¼ˆæ¡ˆä¾‹ï¼‰å‡æƒ³æ€»ä½“ï¼š60ä¸ªå®¶åº­çš„æ”¶æ”¯æ•°æ®ï¼ˆæ‰æ•°æ®å½¢æ€ï¼‰


```{r}
datatable(fams60, options = list(pageLength =9, dom ="t"), caption = "60ä¸ªå®¶åº­çš„æ”¶å…¥å’Œæ”¯å‡ºæƒ…å†µï¼šå‡è®¾çš„æ€»ä½“")
```
???
**æ‰æ•°æ®å½¢æ€**ï¼šâ€œéæ ‡å‡†â€æ•°æ®å½¢æ€ï¼ˆä½†å¾ˆç›´è§‚ï¼‰

---

### ï¼ˆæ¡ˆä¾‹ï¼‰å‡æƒ³æ€»ä½“ï¼š60ä¸ªå®¶åº­çš„æ”¶æ”¯æ•°æ®ï¼ˆé•¿æ•°æ®å½¢æ€ï¼‰

```{r}
datatable(fams60_long, options = list(pageLength =8, dom ="tip"), caption = "60ä¸ªå®¶åº­çš„æ”¶å…¥å’Œæ”¯å‡ºæƒ…å†µï¼šå‡è®¾çš„æ€»ä½“")
```
???
**é•¿æ•°æ®å½¢æ€**ï¼šæ ‡å‡†æ•°æ®å½¢æ€ï¼ˆä½†ä¸ç›´è§‚ï¼‰ã€‚

---
name: basic-important

## é‡è¦æ¦‚å¿µï¼šæ— æ¡ä»¶æ¦‚ç‡å’Œæ— æ¡ä»¶æœŸæœ›

**æ— æ¡ä»¶æ¦‚ç‡**ï¼š

- å®šä¹‰ï¼šä¸å—
$X_i$å˜é‡å–å€¼å½±å“ä¸‹ï¼Œ
$Y_i$å‡ºç°çš„å¯èƒ½æ€§ã€‚

- è®°å·ï¼šç¦»æ•£å˜é‡
$P(Y_i)$ï¼›è¿ç»­å˜é‡
$g(Y)$

**æ— æ¡ä»¶æœŸæœ›**ï¼š

- å®šä¹‰ï¼šä¸å—
$X_i$å˜é‡å–å€¼å½±å“ä¸‹ï¼Œå˜é‡
$Y_i$çš„æœŸæœ›å€¼ã€‚

- è®°å·ï¼š
$g(Y_i)$è¡¨ç¤ºè¿ç»­å˜é‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆcdfï¼‰

$$\begin{align}
E(Y) &= \sum_1^N{Y_i \cdot P(Y_i)} &&\text{(discrete vars)} \\
E(Y) &= \int{Y_i \cdot g(Y_i)dY} &&\text{(continue vars)} 
\end{align}$$

---

### ï¼ˆç¤ºä¾‹ï¼‰æ— æ¡ä»¶æ¦‚ç‡å’Œæ— æ¡ä»¶æœŸæœ›çš„ç¤ºä¾‹è®¡ç®—


```{r, out.width="90%", fig.cap="æ— æ¡ä»¶æ¦‚ç‡å’Œæ— æ¡ä»¶æœŸæœ›"}
include_graphics("../pic/extra/chpt2-1-60fams-unconditional-mean.png")
```

---

### ï¼ˆç¤ºä¾‹ï¼‰æ— æ¡ä»¶æœŸæœ›çš„è®¡ç®—è¿‡ç¨‹

$$\begin{align}
E(Y) &= \sum_1^N{Y_i \cdot P(Y_i)} \\
     &= \sum_1^{60}\left( 55*\frac{1}{60} + 60*\frac{1}{60} + \cdots + 191*\frac{1}{60} \right) \\
     &=\frac{1}{60}\sum_1^{60}Y_i\\
     &=\frac{7272}{60}\\
     &=121.2
\end{align}$$

---

## é‡è¦æ¦‚å¿µï¼šæ¡ä»¶æ¦‚ç‡å’Œæ¡ä»¶æœŸæœ›

**æ¡ä»¶æ¦‚ç‡**ï¼š

- å®šä¹‰ï¼šç»™å®šå˜é‡
$X_i$çš„å–å€¼æ¡ä»¶ä¸‹ï¼Œ
$Y_i$å‡ºç°çš„å¯èƒ½æ€§ã€‚

- è®°å·ï¼šç¦»æ•£å˜é‡
$P(Y_i|X_i)$ï¼›è¿ç»­å˜é‡
$g(Y|X)$


**æ¡ä»¶æœŸæœ›**ï¼š

- åœ¨ç»™å®šå˜é‡
$X_i$çš„å–å€¼æ¡ä»¶ä¸‹ï¼Œ
$Y_i$çš„æœŸæœ›å€¼ã€‚

- è®°å·ï¼š
$g(Y|X)$è¡¨ç¤ºè¿ç»­å˜é‡çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆcdfï¼‰

$$\begin{align}
E(Y|X_i) &= \sum_1^N{(Y_i|X_i) \cdot P(Y_i|X_i)} &&\text{(discrete vars)} \\
E(Y|X_i) &= \int{(Y|X) \cdot g(Y|X)dY} &&\text{(continue vars)} \end{align}$$

---

### ï¼ˆç¤ºä¾‹ï¼‰æ¡ä»¶æ¦‚ç‡å’Œæ¡ä»¶æœŸæœ›çš„è®¡ç®—

```{r, out.width="90%",fig.cap="æ¡ä»¶æ¦‚ç‡å’Œæ¡ä»¶æœŸæœ›"}
include_graphics("../pic/extra/chpt2-1-60fams-conditional-mean.png")
```

---

### ï¼ˆç¤ºä¾‹ï¼‰æ¡ä»¶æœŸæœ›çš„è®¡ç®—è¿‡ç¨‹

$$\begin{align}
E(Y|80) &= \sum_1^N{Y_i \cdot P(Y_i|X=80)} \\
     &= \sum_1^{5}\left( 55*\frac{1}{5} + 60*\frac{1}{5} + \cdots + 75*\frac{1}{5} \right) \\
     &=\frac{1}{5}\sum_1^{5}Y_i\\
     &=\frac{325}{5}\\
     &=65
\end{align}$$

---

### ï¼ˆç¤ºä¾‹ï¼‰å‡æƒ³æ€»ä½“çš„å…¨éƒ¨æ•°æ®å±•ç¤º


```{r, out.width="90%"}
# the population points
p1<- ggplot() +
  geom_point(data = fams60_long,
             aes(x=X,  y=Y,color= "Y", shape="Y"),size=3) +
  scale_colour_manual(name= "",
                      values =c("blue")) +
  scale_shape_manual(name= "",
                      values =c(1)) +
  scale_x_continuous(breaks=seq(80,260, length=10)) +
  labs(x="å®¶åº­æ”¶å…¥X", y="å®¶åº­æ”¯å‡ºY") +
  theme(text = element_text(size=18),
        axis.title.x = element_text(size = 16,
                                margin = margin(t = 15, r = 0, 
                                                b = 0, l = 0)),
        axis.title.y = element_text(size = 16,
                                margin = margin(t = 0, r = 15, 
                                                b = 0, l = 0)))

p1
```


---

### ï¼ˆç¤ºä¾‹ï¼‰ç»™å®šä¸åŒXæ°´å¹³ä¸‹Yæ¡ä»¶æœŸæœ›å€¼

```{r, fig.height= 5.5}
# the expect points
p2 <- p1 +
  geom_point(data = pivot_exp, 
             aes(x=X, y=exp.Y,
                 color= "E(Y|X)",shape= "E(Y|X)"), size=3) +
  scale_colour_manual(name= "",
                      values =c("red","blue")) +
  scale_shape_manual(name= "",values =c(19,1)) 

p2
```


```{r}
kable(exp_cond) %>%
  kable_styling(full_width =T)
```

---

### ï¼ˆç¤ºä¾‹ï¼‰ç»™å®šä¸åŒXæ°´å¹³ä¸‹Yæ¡ä»¶æœŸæœ›å€¼

```{r, out.width="90%" , warning=FALSE,message=FALSE}
# the specified point
require("latex2exp")
X_spc <- 120
Y_spc <- pivot_exp$exp.Y[which(pivot_exp$X==X_spc)]
p2_1 <- p2 +
  geom_vline(aes(xintercept = X_spc), lty="dashed")+
  geom_hline(aes(yintercept = Y_spc), lty="dashed")+
  geom_text(aes(x=X_spc-22, y=Y_spc+10), label=TeX("$(X_i,E(Y|X_i))=(120,89)$"),
            color="red",size=5)

p2_1
```

ç»™å®š
$X=120$æ°´å¹³ä¸‹
$Y$æ¡ä»¶æœŸæœ›å€¼
$E(Y|X_i=120)$= `r pivot_exp$exp.Y[which(pivot_exp$X==X_spc)]`

---

### ï¼ˆç¤ºä¾‹ï¼‰Xå‡å€¼å’ŒYçš„æ— æ¡ä»¶æœŸæœ›å€¼

```{r, out.width="90%", warning=FALSE,message=FALSE}
# the center point
X_bar <- mean(fams60_long$X)
Y_bar <- mean(fams60_long$Y)
p3 <- p2 +
  geom_vline(aes(xintercept = X_bar), lty="dashed")+
  geom_hline(aes(yintercept = Y_bar), lty="dashed")+
  geom_text(aes(x=X_bar-20, y=Y_bar+10), label=TeX("$(\\bar{X},\\bar{Y})=(174, 121)$"),color="orange",size=5)+
  #geom_text(aes(x=15, y=mean(fams60_long$Y)+5), label=TeX("$E(Y)=\\bar{Y}$"))+
  geom_point(aes(x=X_bar, y=Y_bar,
                 color="center", shape="center"),size=3) +
  scale_colour_manual(name= "",
                      values =c("E(Y|X)"="red", "Y"="blue", "center" ="orange")) +
  scale_shape_manual(name= "",
                      values =c("E(Y|X)"=19,"Y"=1,"center" =17)) 
p3
```

Xçš„å‡å€¼
$\bar{X}$
=`r formatC(X_bar, format="f", digits =2)`å’ŒYçš„æ— æ¡ä»¶æœŸæœ›å€¼
$E(Y)=$
`r formatC(Y_bar, format ="f", digits = 2)`

---

## é‡è¦æ¦‚å¿µï¼šæ€»ä½“å›å½’çº¿ï¼ˆPRLï¼‰

- å‡ ä½•ï¼šç»™å®šXå€¼æ—¶Yçš„æ¡ä»¶æœŸæœ›å€¼çš„è½¨è¿¹ã€‚

- ç»Ÿè®¡ï¼šå®è´¨ä¸Šå°±æ˜¯Yå¯¹Xçš„å›å½’ã€‚

æ€»ä½“å›å½’æ›²çº¿(Population Regression Curveï¼ŒPRC)ï¼šæ¡ä»¶æœŸæœ›å€¼çš„è½¨è¿¹è¡¨ç°ä¸ºä¸€æ¡æ›²çº¿(Curve)ã€‚

æ€»ä½“å›å½’çº¿(Population Regression Lineï¼ŒPRL)ï¼šæ¡ä»¶æœŸæœ›å€¼çš„è½¨è¿¹è¡¨ç°ä¸ºä¸€æ¡ç›´çº¿(Line)ã€‚

---

## é‡è¦æ¦‚å¿µï¼šæ€»ä½“å›å½’çº¿ï¼ˆPRLï¼‰

```{r, out.width="90%", fig.cap="æ€»ä½“å›å½’çº¿PRL"}
p_PRL <- p2 +
  geom_line(data = pivot_exp,aes(x=X, y=exp.Y),color="purple", size=0.75)
p_PRL
```

---

## é‡è¦æ¦‚å¿µï¼šæ€»ä½“å›å½’å‡½æ•°ï¼ˆPRFï¼‰

æ€»ä½“å›å½’å‡½æ•°ï¼ˆPopulation Regression Functionï¼ŒPRFï¼‰ï¼šå®ƒæ˜¯å¯¹æ€»ä½“å›å½’æ›²çº¿(PRC)çš„æ•°å­¦å‡½æ•°è¡¨ç°å½¢å¼ã€‚

å¦‚æœä¸çŸ¥é“æ€»ä½“å›å½’æ›²çº¿çš„å…·ä½“å½¢å¼ï¼Œåˆ™æ€»ä½“å›å½’å‡½æ•°PRFè¡¨è¾¾ä¸ºå¦‚ä¸‹éšå‡½æ•°å½¢å¼ï¼ˆPRFï¼‰ï¼š

$$\begin{align}
E(Y|X_i) & = f(X_i)  && \text{(PRF)}
\end{align}$$

å¦‚æœæ€»ä½“å›å½’æ›²çº¿æ˜¯ç›´çº¿å½¢å¼ï¼Œåˆ™æ€»ä½“å›å½’å‡½æ•°PRFè¡¨è¾¾ä¸ºå¦‚ä¸‹æ˜¾å‡½æ•°å½¢å¼ï¼ˆPRF_Lï¼‰ï¼š

$$\begin{align}
E(Y|X_i) &= \beta_1 +\beta_2X_i && \text{(PRF_L)}
\end{align}$$

- 
$\beta_1,\beta_2$åˆ†åˆ«ç§°ä¸ºæˆªè·(intercept)å’Œæ–œç‡ç³»æ•°(slope coefficient)ã€‚

- 
$\beta_1,\beta_2$ç§°ä¸ºæ€»ä½“å‚æ•°æˆ–å›å½’ç³»æ•°(regression coefficients)ã€‚

- 
$\beta_1,\beta_2$ä¸ºæœªçŸ¥ä½†å´æ˜¯å›ºå®šçš„å‚æ•°ã€‚

---

## é‡è¦æ¦‚å¿µï¼šæ€»ä½“å›å½’å‡½æ•°ï¼ˆPRFï¼‰

```{r, out.width="90%", fig.cap="æ€»ä½“å›å½’çº¿PRLä¸æ€»ä½“å›å½’å‡½æ•°PRF", warning=FALSE,message=FALSE}
lm_pop<- lm(data = pivot_exp, formula = exp.Y~X)
b1 <- coef(lm_pop)[1]
b0 <- coef(lm_pop)[2]
p_PRF <- p_PRL +
  geom_text(aes(x=120, y=200),
            label=TeX("$PRF:E(Y|X_i)=\\beta_1+\\beta_2X_i$"),
            color="purple", size=5) +
    geom_text(aes(x=120, y=190),
            label=TeX("$E(Y|X_i)=17+0.6X_i$"),
            color="purple", size=5) 
p_PRF
```

---

## é‡è¦æ¦‚å¿µï¼šæ€»ä½“å›å½’æ¨¡å‹ï¼ˆPRMï¼‰

**æ€»ä½“å›å½’æ¨¡å‹**ï¼ˆPopulation Regression model, PRMï¼‰ï¼šæŠŠæ€»ä½“å›å½’å‡½æ•°è¡¨è¾¾æˆ**éšæœºè®¾å®š**å½¢å¼ã€‚

å¦‚æœæ€»ä½“å›å½’å‡½æ•°ä¸ºéšå‡½æ•°ï¼Œåˆ™**æ€»ä½“å›å½’æ¨¡å‹**è®°ä¸ºï¼š

$$\begin{align}
Y_i &=  E(Y|X_i) + u_i \\
    &=  f(X_i) +u_i
\end{align}$$

å¦‚æœæ€»ä½“å›å½’å‡½æ•°ä¸ºçº¿æ€§å‡½æ•°ï¼Œåˆ™**æ€»ä½“å›å½’æ¨¡å‹**è®°ä¸ºï¼š

$$\begin{align}
Y_i &=  E(Y|X_i) + u_i \\
    &= \beta_1 +\beta_2X_i + u_i
\end{align}$$

- æ€»ä½“å›å½’æ¨¡å‹ï¼ˆPRMï¼‰å±äº**è®¡é‡ç»æµå­¦æ¨¡å‹**ï¼Œè€Œæ€»ä½“å›å½’å‡½æ•°ï¼ˆPRFï¼‰æ˜¯**æ•°é‡ç»æµå­¦æ¨¡å‹**ï¼ˆæˆ–æ•°å­¦æ¨¡å‹ï¼‰ã€‚

- æ€»ä½“å›å½’æ¨¡å‹ï¼ˆPRMï¼‰èƒ½å……åˆ†è¡¨è¾¾çš„æ˜¯ç°å®ä¸–ç•Œä¸­
$Y_i$å˜é‡çš„è¡Œä¸ºç‰¹å¾ã€‚


---

## é‡è¦æ¦‚å¿µï¼šéšæœºå¹²æ‰°é¡¹

æ€»ä½“å›å½’æ¨¡å‹ï¼ˆPRMï¼‰è®¾å®šä¸‹ï¼Œ
$Y_i$å°†ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆã€‚

- ç‰¹å®šå®¶åº­çš„æ”¯å‡ºï¼ˆ
$Y_i$ï¼‰ = ç³»ç»Ÿæ€§éƒ¨åˆ†ï¼ˆ
$E(Y|X_i)$ + éšæœºéƒ¨åˆ†ï¼ˆ
$u_i$ï¼‰

- ç‰¹å®šå®¶åº­çš„æ”¯å‡ºï¼ˆ
$Y_i$ï¼‰ = ç³»ç»Ÿæ€§éƒ¨åˆ†ï¼ˆ
$\beta_1+\beta_2X_i$ï¼‰ + éšæœºéƒ¨åˆ†ï¼ˆ
$u_i$ï¼‰


**éšæœºå¹²æ‰°é¡¹**ï¼š

- ä¹Ÿè¢«ç§°ä¸ºéšæœºè¯¯å·®é¡¹(stochastic error term)ï¼šæ€»ä½“å›å½’å‡½æ•°ä¸­å¿½ç•¥æ‰çš„ä½†åˆå½±å“ç€Yçš„å…¨éƒ¨å˜é‡çš„æ›¿ä»£ç‰©ï¼Œå®ƒæ˜¯
$Y_i$ä¸æ¡ä»¶æœŸæœ›ï¼ˆ
$E(Y|X_i)$ï¼‰çš„ç¦»å·®ã€‚

$$\begin{align}
u_i &= Y_i - E(Y|X_i) 
\end{align}$$

---

## é‡è¦æ¦‚å¿µï¼šéšæœºå¹²æ‰°é¡¹

éšæœºå¹²æ‰°é¡¹çš„æ¥æºï¼š

- ç†è®ºçš„å«ç³Šï¼šé™¤äº†ä¸»å˜é‡ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶å®ƒå˜é‡çš„å½±å“ï¼Œä½†ä¸æ¸…æ¥šï¼Œåªèƒ½ç”¨ğœ‡_ğ‘–ä»£æ›¿å®ƒä»¬ã€‚ï¼ˆå®¶åº­æ”¶å…¥ä»¥å¤–ï¼Ÿï¼‰

- æ•°æ®çš„ä¸å……åˆ†ï¼šå¯èƒ½çŸ¥é“è¢«å¿½ç•¥çš„å˜é‡ï¼Œä½†ä¸èƒ½å¾—åˆ°è¿™äº›å˜é‡çš„æ•°é‡ä¿¡æ¯ã€‚ï¼ˆå¦‚å®¶åº­è´¢å¯Œæ•°æ®ä¸å¯å¾—ï¼‰

- æ ¸å¿ƒå˜é‡ä¸å…¶å®ƒå˜é‡ï¼šå…¶å®ƒå˜é‡å…¨éƒ¨æˆ–å…¶ä¸­ä¸€äº›åˆèµ·æ¥å½±å“è¿˜æ˜¯å¾ˆå°çš„ã€‚ï¼ˆå¦‚å­å¥³ã€æ•™è‚²ã€æ€§åˆ«ã€å®—æ•™ç­‰ï¼‰

- äººç±»è¡Œä¸ºçš„å†…åœ¨éšæœºæ€§ã€‚ï¼ˆå®¢è§‚å­˜åœ¨ã€å›ºæœ‰çš„ï¼‰

- å˜é‡è¢«â€œç§»èŠ±æ¥æœ¨â€è€Œäº§ç”Ÿæµ‹é‡è¯¯å·®ï¼ˆå¦‚å¼—é‡Œå¾·æ›¼çš„æŒä¹…æ”¶å…¥å’Œæ¶ˆè´¹ï¼‰

- èŠ‚çœåŸåˆ™ï¼šä¸ºäº†ä¿æŒä¸€ä¸ªå°½å¯èƒ½ç®€å•çš„å›å½’æ¨¡å‹

- é”™è¯¯çš„å‡½æ•°å½¢å¼ï¼šæœ‰æ—¶æ ¹æ®æ•°æ®åŠç»éªŒæ— æ³•ç¡®å®šä¸€ä¸ªæ­£ç¡®çš„å‡½æ•°å½¢å¼ ï¼ˆå¤šå…ƒå›å½’å°¤å…¶å¦‚æ­¤ï¼‰

---

## é‡è¦æ¦‚å¿µï¼šéšæœºå¹²æ‰°é¡¹


.pull-left[
ä¸ºä½•æ˜¯â€œéšæœºçš„â€ï¼Ÿ

- æµ‹ä¸å‡†ï¼Ÿï¼ˆè¯¯å·®ï¼‰

- æµ‹é”™äº†ï¼Ÿï¼ˆè¯¯å¯¼ï¼‰

- å…ä¸äº†!ï¼ˆå†…åœ¨æ€§ï¼‰

]

.pull-right[

æ‹¥æŠ±éšæœºä¸–ç•Œ

- é£ç­ï¼š
$Y_i$

- é£ç­çº¿ï¼š
$E(Y|X_i)$

- é£ï¼š
$u_i$

]


---

## é‡è¦æ¦‚å¿µï¼šç†è§£PRMå’ŒPRFçš„å…³ç³»

```{r, out.width="90%", warning=FALSE,message=FALSE}
Y_spc2 <- min(fams60_long$Y[which(fams60_long$X==X_spc)])

p_PRM_demo<- p_PRF +
  geom_point(aes(x=X_spc,y=Y_spc), shape=2,size=3)+
  geom_point(aes(x=X_spc,y=Y_spc2), shape=1, color="black",size=3)+
  geom_hline(aes(yintercept = Y_spc), lty= "dashed") +
  geom_text(aes(x=X_spc+25,y=Y_spc+4),
             label=paste0("E(Y|",X_spc,")=",Y_spc),size=5) +
  geom_hline(aes(yintercept = Y_spc2), lty= "dashed") +
  geom_text(aes(x=X_spc+25,y=Y_spc2-4),
             label=paste0("(Yi|", X_spc,")=",Y_spc2),size=5) 
  
p_PRM_demo
```

è‹¥ç»™å®šä¸€ä¸ªç‰¹å®šå®¶åº­
$(X_i=120, Y_i=79)$ï¼Œåˆ™æ¡ä»¶æœŸæœ›ä¸º
$E(Y|120)=89$


---

## é‡è¦æ¦‚å¿µï¼šç†è§£PRMå’ŒPRFçš„å…³ç³»

è‹¥ç»™å®š
$X_i=`r X_spc`$ï¼Œåˆ™5ä¸ªå®¶åº­çš„çœŸå®æ¶ˆè´¹æ”¯å‡ºåˆ†åˆ«ä¸ºï¼š

$$\begin{align}
(Y_1|X=120) = 79 &= \beta_1 + \beta_2 \cdot 120 +u_1\\
(Y_2|X=120) = 84 &= \beta_1 + \beta_2 \cdot 120 +u_2\\
(Y_3|X=120) = 90 &= \beta_1 + \beta_2 \cdot 120 +u_3\\
(Y_4|X=120) = 94 &= \beta_1 + \beta_2 \cdot 120 +u_4\\
(Y_5|X=120) = 98 &= \beta_1 + \beta_2 \cdot 120 +u_5
\end{align}$$


---

## é‡è¦æ¦‚å¿µï¼šç†è§£PRMå’ŒPRFçš„å…³ç³»

ä¸»è¦ç»“è®ºï¼š

- æ€»ä½“æœŸæœ›åˆ»ç”»æ€»ä½“çš„â€œè¶‹åŠ¿â€ï¼Œæ€»ä½“å›å½’çº¿è®©â€œè¶‹åŠ¿â€ç›´è§‚åŒ–ã€‚

- ä¸ªä½“éšæœºæ€§æ˜¯ä¸å¯é¿å…çš„ï¼Œæ€»ä¼šâ€œæ¸¸ç¦»â€äºâ€œè¶‹åŠ¿â€ä¹‹å¤–ã€‚

- éšæœºå¹²æ‰°é¡¹
$u_i$ğ‘–æºå¸¦äº†éšæœºä¸ªä½“çš„â€œæ¸¸ç¦»â€ä¿¡æ¯ã€‚

- æ€»ä½“å›å½’æ¨¡å‹æ—¢â€œæå–â€äº†è¶‹åŠ¿å’Œè§„å¾‹æ€§ï¼Œåˆâ€œç»´ç³»â€ç€ä¸ªä½“éšæœºæ€§ï¼Œä»è€Œæ›´å¥½åœ°è¡¨è¾¾äº†â€œçœŸå®ä¸–ç•Œâ€ã€‚

è¯¾åæ€è€ƒï¼š

- å¦‚æœæ˜¯æ— é™æ€»ä½“ï¼Œæ€»ä½“çš„è§„å¾‹æ€§åœ¨ç†è®ºä¸Šä¹Ÿæ˜¯å¯ä»¥è¢«ä¸¥æ ¼è¡¨è¾¾å‡ºæ¥ä¹ˆï¼Ÿ

- å¦‚æœä¸å‘Šè¯‰ä½ æ€»ä½“ï¼Œä½ æ€ä¹ˆçŸ¥é“â€œè§¦ç¢°â€åˆ°çš„æ˜¯â€œçœŸå®çš„â€è¶‹åŠ¿/è§„å¾‹ï¼Ÿ

- ä»å‡æƒ³çš„60ä¸ªå®¶åº­çš„å¾®å‹æ€»ä½“ä¸­ï¼Œâ€œéšä¾¿â€æŠ½å–10ä¸ªå®¶åº­çš„æ•°æ®ï¼Œä½ è¿˜èƒ½çœ‹åˆ°â€œç›´çº¿â€è¶‹åŠ¿ä¹ˆï¼Ÿ


---

## é‡è¦æ¦‚å¿µï¼šâ€œçº¿æ€§â€çš„å«ä¹‰

â€œçº¿æ€§å›å½’æ¨¡å‹â€ä¸­â€œçº¿æ€§â€ä¸€è¯çš„å«ä¹‰

- **å˜é‡â€œçº¿æ€§â€æ¨¡å‹**ï¼šå› å˜é‡å¯¹äºè‡ªå˜é‡æ˜¯çº¿æ€§çš„ã€‚

- **å‚æ•°â€œçº¿æ€§â€æ¨¡å‹**ï¼šå› å˜é‡å¯¹äºå‚æ•°æ˜¯çº¿æ€§çš„ã€‚

---

### ï¼ˆæµ‹è¯•é¢˜ï¼‰â€œçº¿æ€§â€çš„å«ä¹‰

ä¸‹åˆ—æ¨¡å‹åˆ†åˆ«å±äºå“ªä¸€ç±»ï¼Ÿè¯·æŒ‡å‡ºæ¥ï¼š

$$\begin{align}
Y_i &= \beta_1 + \beta_2 X_i +u_i && \text{(mod1)}
\end{align}$$

$$\begin{align}
Y_i &= \beta_1 + \beta_2 X_i + \beta_3 X_i^2 +u_i && \text{(mod2)}
\end{align}$$

$$\begin{align}
Y_i &= \beta_1 + \beta_2 X_i + \beta_3 X_i^2 + \beta_4 X_i^3 +u_i && \text{(mod3)}
\end{align}$$

$$\begin{align}
Y_i &= \beta_1 + \beta_2 \frac{1}{X_i} +u_i && \text{(mod4)}
\end{align}$$


$$\begin{align}
Y_i &= \beta_1 + \beta_2 ln(X_i) +u_i && \text{(mod5)} \\
\end{align}$$



$$\begin{align}
ln(Y_i) &= \beta_1 + \beta_2 X_i +u_i && \text{(mod6)}
\end{align}$$

---

### ï¼ˆæµ‹è¯•é¢˜ï¼‰â€œçº¿æ€§â€çš„å«ä¹‰

ä¸‹åˆ—æ¨¡å‹åˆ†åˆ«å±äºå“ªä¸€ç±»ï¼Ÿè¯·æŒ‡å‡ºæ¥ï¼š

$$\begin{align}
ln(Y_i) &= \beta_1 - \beta_2 \frac{1}{X_i} +u_i && \text{(mod7)} 
\end{align}$$


$$\begin{align}
ln(Y_i) &= ln(\beta_1) + \beta_2 ln(X_i) +u_i && \text{(mod8)} 
\end{align}$$


$$\begin{align}
Y_i &= \frac{1}{1+e^{(\beta_1 + \beta_2 X_{2i}  +u_i) }} && \text{(mod9)}
\end{align}$$


$$\begin{align}
Y_i &= \beta_1 +(0.75-\beta_1)e^{-\beta_2(X_i-2)} +u_i && \text{(mod10)}
\end{align}$$


$$\begin{align}
Y_i &= \beta_1 + \beta_2^3 X_i +u_i && \text{(mod11)} 
\end{align}$$

---

## é‡è¦æ¦‚å¿µï¼šæ ·æœ¬å›å½’çº¿(SRL)

**æ ·æœ¬(Sample)**ï¼š

- ä»æ€»ä½“ä¸­éšæœºæŠ½å–å¾—åˆ°çš„æ•°æ®ã€‚

**æ ·æœ¬å›å½’çº¿**(Sample Regression Lineï¼ŒSRL)ï¼š

- æ˜¯é€šè¿‡æ‹Ÿåˆ**æ ·æœ¬æ•°æ®**å¾—åˆ°çš„ä¸€æ¡æ›²çº¿ï¼ˆæˆ–ç›´çº¿ï¼‰ã€‚æ¢è¨€ä¹‹ï¼Œè¿™æ¡çº¿ç”±æ‹Ÿåˆå€¼
$\hat{Y}_i$è¿æ¥è€Œæˆã€‚

- 
$\hat{Y}_i$æ˜¯å¯¹æ¡ä»¶æœŸæœ›å€¼
$Y|X_i$çš„æ‹Ÿåˆã€‚

- æ‹Ÿåˆæ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚é‡‡ç”¨OLSæ–¹æ³•å¯¹æ ·æœ¬æ•°æ®è¿›è¡Œæ‹Ÿåˆã€‚

    - å°½å¯èƒ½æ‹Ÿåˆæ•°æ®
    - ç”¨ä»€ä¹ˆæ–¹æ³•æ‹Ÿåˆï¼Ÿ
    - æ›²çº¿æ˜¯ä»€ä¹ˆå½¢æ€ï¼Ÿ


---

## é‡è¦æ¦‚å¿µï¼šæ ·æœ¬å›å½’å‡½æ•°(SRF)

**æ ·æœ¬å›å½’å‡½æ•°**(Sample Regression Functionï¼ŒSRF)ï¼šæ˜¯æ ·æœ¬å›å½’æ›²çº¿çš„æ•°å­¦å‡½æ•°å½¢å¼ï¼Œå¯æ˜¯æ˜¯çº¿æ€§çš„æˆ–éçº¿æ€§ã€‚å¦‚æœæ˜¯ç›´çº¿åˆ™å¯ä»¥å†™æˆï¼š

$$\begin{align}
\hat{Y}_i =\hat{\beta}_1 + \hat{\beta}_2X_i
\end{align}$$

å¯¹æ¯”æ€»ä½“å›å½’å‡½æ•°ï¼ˆPRFï¼‰ï¼š

$$\begin{align}
E(Y|X_i) =\beta_1 + \beta_2X_i
\end{align}$$

å¯ä»¥è®¤ä¸ºï¼š

- 
$\hat{Y}_i$æ˜¯å¯¹
$E(Y|X_i)$çš„ä¼°è®¡é‡ã€‚

- 
$\hat{\beta}_1$æ˜¯å¯¹
$\beta_1$çš„ä¼°è®¡é‡ã€‚

- 
$\hat{\beta}_2$æ˜¯å¯¹
$\beta_2$çš„ä¼°è®¡é‡ã€‚

---

### ï¼ˆç¤ºä¾‹ï¼‰ç¬¬ä¸€ä»½éšæœºæ ·æœ¬ï¼šæŠ½æ ·

```{r}
set.seed("123")
sample1<- fams60_long %>% 
  mutate(group = as.factor(group)) %>%
  group_by(group) %>%
  sample_n(size=1) %>% ungroup() %>% select(-id,-group)

set.seed("124")
sample2<- fams60_long %>% 
  mutate(group = as.factor(group)) %>%
  group_by(group) %>%
  sample_n(size=1) %>% ungroup() %>% select(-id,-group) 

```


```{r, fig.height=6}
p_spl1 <- p1 +
  geom_point(data = sample1, 
         aes(x=X, y=Y, shape="sample1", color="sample1"),
         size=3)+
  scale_colour_manual(name= "",
                      values =c("black","blue")) +
  scale_shape_manual(name= "",
                      values =c(15,1))

p_spl1
```

```{r, warning=FALSE,message=FALSE}
old.names <- str_c("V",1:10)
new.names <- str_c("n",1:10)
sample1_t<- sample1 %>% 
  t(.) %>% as_tibble(.) %>% 
  rename_at(vars(old.names), ~ new.names) %>%
  add_column(var=c("X","Y"), .before = "n1") 

kable(sample1_t)
```

---

### ï¼ˆç¤ºä¾‹ï¼‰ç¬¬ä¸€ä»½éšæœºæ ·æœ¬ï¼šæ•°æ®

```{r, fig.height=6}
p_spl_base<- ggplot(sample1, aes(X, Y)) +
  geom_blank() +
  scale_x_continuous(breaks=seq(80,260, length=10)) +
  scale_y_continuous(breaks=seq(50,150, length=3)) +
  labs(x="å®¶åº­æ”¶å…¥X", y="å®¶åº­æ”¯å‡ºY") +
  theme(text=element_text(size=16))

p_spl1_alone <- p_spl_base +
  geom_point(aes(shape="sample1"), color="black",size=3)+
  scale_y_continuous(breaks=seq(50,150, length=3)) +
  scale_shape_manual(name= "",
                      values =c(15))

p_spl1_alone
```

```{r}
kable(sample1_t)
```

---

### ï¼ˆç¤ºä¾‹ï¼‰ç¬¬ä¸€ä»½éšæœºæ ·æœ¬ï¼šSRL

```{r, warning=F}
mod_spl <- formula("Y~X")
coef_mod1<- fun_lm_coef(lm.mod = mod_spl, lm.dt = sample1)
```


```{r, fig.height=6, warning=F}
p_spl1_SRL<- p_spl1_alone +
  geom_abline( intercept = coef_mod1$coef[1], slope= coef_mod1$coef[2], color="black") +
  geom_text(aes(x=120,y=170),
             label=TeX("$\\hat{Y_i}=\\hat{\\beta}_1+\\hat{\\beta}_2X_i$"),size=5) +
  geom_text(aes(x=120,y=160),
             label=TeX("$\\hat{Y}=17.81+0.62X_i$"),size=5) 
p_spl1_SRL  
```

```{r}
kable(sample1_t)
```

---

### ï¼ˆç¤ºä¾‹ï¼‰ç¬¬ä¸€ä»½éšæœºæ ·æœ¬ï¼šSRF

æ ¹æ®ç¬¬ä¸€ä»½éšæœºæ ·æœ¬æ‹Ÿåˆå¾—åˆ°çš„**æ ·æœ¬å›å½’å‡½æ•°**SRFï¼š

```{r ,results="asis"}
fun_report_eq(lm.mod = mod_spl, lm.dt = sample1,
              lm.simple=TRUE,lm.n = 2)
```

æ ·æœ¬æ•°æ®å¦‚ä¸‹ï¼š

```{r}
kable(sample1_t)
```


---

### ï¼ˆç¤ºä¾‹ï¼‰ç¬¬äºŒä»½éšæœºæ ·æœ¬ï¼šæŠ½æ ·

```{r, warning=FALSE,message=FALSE}
sample2_t<- sample2 %>% 
  t(.) %>% as_tibble(.) %>% 
  rename_at(vars(old.names), ~ new.names) %>%
  add_column(var=c("X","Y"), .before = "n1")
```

```{r, fig.height=6}
p_spl2 <- p1 +
  geom_point(data = sample2, 
         aes(x=X, y=Y, shape="sample2", color="sample2"),size=3)+
  scale_colour_manual(name= "",
                      values =c("purple","blue")) +
  scale_shape_manual(name= "",
                      values =c(17,1))

p_spl2
```

```{r}
kable(sample2_t)
```


---

### ï¼ˆç¤ºä¾‹ï¼‰ç¬¬äºŒä»½éšæœºæ ·æœ¬ï¼šæ•°æ®


```{r, fig.height=6}
p_spl2_alone <- p_spl_base +
geom_point(data=sample2,aes(shape="sample2"), color="purple",size=3)+
  scale_y_continuous(breaks=seq(50,150, length=3)) +
  scale_shape_manual(name= "",
                      values =c(17))

p_spl2_alone
```

```{r}
kable(sample2_t)
```

---

### ï¼ˆç¤ºä¾‹ï¼‰ç¬¬äºŒä»½éšæœºæ ·æœ¬ï¼šSRL

```{r, warning=F}
coef_mod2<- fun_lm_coef(lm.mod = mod_spl, lm.dt = sample2)
```


```{r, fig.height=6, warning=F}
p_spl2_SRL<- p_spl2_alone +
  geom_abline( intercept = coef_mod2$coef[1], slope= coef_mod2$coef[2], color="purple") +
  geom_text(aes(x=120,y=170),
             label=TeX("$\\hat{Y_i}=\\hat{\\beta}_1+\\hat{\\beta}_2X_i$"),size=5) +
  geom_text(aes(x=120,y=160),
             label=TeX("$\\hat{Y}=7.12+0.65X_i$"),size=5) 
p_spl2_SRL  
```

```{r}
kable(sample2_t)
```

---

### ï¼ˆç¤ºä¾‹ï¼‰ç¬¬äºŒä»½éšæœºæ ·æœ¬ï¼šSRF

æ ¹æ®ç¬¬äºŒä»½éšæœºæ ·æœ¬æ‹Ÿåˆå¾—åˆ°çš„**æ ·æœ¬å›å½’å‡½æ•°**SRFï¼š


```{r, results="asis"}
fun_report_eq(lm.mod = mod_spl, lm.dt = sample2,
              lm.simple = TRUE)
```


æ ·æœ¬æ•°æ®å¦‚ä¸‹ï¼š

```{r}
kable(sample2_t)
```

---

### ï¼ˆç¤ºä¾‹ï¼‰ä¸¤ä»½æ ·æœ¬åŒæ—¶å‡ºç°ï¼š

```{r,warning=FALSE}
sample_all<- rbind(sample1, sample2) %>%
  add_column(cat= rep(c("sample1", "sample2"), c(10,10)),
             .before = "X")
```

```{r, fig.height=6,warning=FALSE}
p_sample_all<- p2 + 
  geom_point(data = sample1, 
             aes(x=X, y=Y),color="black", shape=15)+
  geom_point(data = sample2, 
             aes(x=X, y=Y),color="purple", shape=17)+
  geom_abline( intercept = coef_mod1$coef[1], slope= coef_mod1$coef[2], color="black",lty="dashed") +
  geom_abline( intercept = coef_mod2$coef[1], slope= coef_mod2$coef[2], color="red",lty="dashed") +
  geom_abline( intercept = 17, slope= 0.6, color="purple") +
  geom_text(aes(x=120,y=180),
             label=TeX("$SRL1:\\hat{Y}=17.81+0.62X_i$"), color="black",size=5)+
  geom_text(aes(x=120,y=170),
             label=TeX("$SRL2:\\hat{Y}=7.12+0.65X_i$"), color="purple",size=5) +
  geom_text(aes(x=120,y=160),
             label=TeX("$PRL:\\hat{Y}=17+0.6X_i$"), color="red",size=5) 
  
  
p_sample_all
```


---

## é‡è¦æ¦‚å¿µï¼šæ ·æœ¬å›å½’æ¨¡å‹ï¼ˆSRMï¼‰

æ ·æœ¬å›å½’æ¨¡å‹ï¼ˆSample Regression Modelï¼ŒSRMï¼‰ï¼šæŠŠæ ·æœ¬å›å½’å‡½æ•°è¡¨ç°ä¸º**â€œéšæœºâ€**å½¢å¼ã€‚

- å¦‚æœæ ·æœ¬å›å½’å‡½æ•°ä¸ºéšå‡½æ•°ï¼Œåˆ™æ ·æœ¬å›å½’æ¨¡å‹å¯è®°ä¸ºï¼š

$$\begin{align}
Y_i &= g(X_i) +e_i 
\end{align}$$

- å¦‚æœæ ·æœ¬å›å½’å‡½æ•°è¡¨ç°ä¸ºç›´çº¿ï¼Œåˆ™æ ·æœ¬å›å½’æ¨¡å‹å¯è®°ä¸ºï¼š

$$\begin{align}
Y_i &= \hat{\beta}_1 +\hat{\beta}_2X_i +e_i && \text{(SRM_L)}
\end{align}$$

å…¶ä¸­ï¼Œ
$e_i$è¡¨ç¤ºæ®‹å·®ï¼ˆResidualï¼‰

---

## é‡è¦æ¦‚å¿µï¼šæ®‹å·®

æ®‹å·®ï¼ˆResidualï¼‰ï¼š

- å®šä¹‰ï¼šæ˜¯æ ·æœ¬å›å½’å‡½æ•°ä¸Yçš„æ ·æœ¬è§‚æµ‹å€¼ä¹‹é—´çš„ç¦»å·®ã€‚

- è®°å·ï¼š

$$\begin{align}
e_i  &= Y_i - \hat{Y}_i \\
     &= Y_i - (\hat{\beta}_1 +\hat{\beta}_2X_i) 
\end{align}$$

---

## é‡è¦æ¦‚å¿µï¼šç†è§£SRFå’ŒSRMçš„å…³ç³»

```{r, warning=FALSE, message=FALSE}
x_spc_spl2 <- 240
Y_spc_spl2 <- sample2$Y[which(sample2$X==x_spc_spl2)]
lm.spl2 <- lm(formula = mod_spl, data = sample2)
Y_spc_fit <- round(lm.spl2$fitted.values[which(sample2$X==x_spc_spl2)],1)

p_SRL_SRF <- p_spl2_SRL +
  geom_vline(aes(xintercept = x_spc_spl2), lty="dashed") +
  geom_hline(aes(yintercept = Y_spc_spl2), lty="dashed")+
  geom_hline(aes(yintercept = Y_spc_fit), lty="dashed") +
  geom_point(aes(x=x_spc_spl2, y= Y_spc_fit), shape=1, size=3,color="red") +
  geom_text(aes(x=x_spc_spl2+15, y=Y_spc_spl2-5), 
            label=  paste0("(",x_spc_spl2,"," ,Y_spc_spl2-5,")"),size=5)+
  geom_text(aes(x=x_spc_spl2+15, y=Y_spc_fit, 
            label= paste0("(",x_spc_spl2,"," ,Y_spc_fit,")")),size=5)

p_SRL_SRF 

```

ç»™å®š
$x_i=`r x_spc_spl2`$ï¼Œæ ·æœ¬2çš„è§‚æµ‹å€¼
$Y_i=`r x_spc_spl2`$ ï¼›æ‹Ÿåˆå€¼
$\hat{Y}_i=$ `r Y_spc_fit`ï¼›æ®‹å·®
$e_i=Y_i- \hat{Y}_i=$ `r Y_spc_spl2 -Y_spc_fit`ã€‚

---

## é‡è¦æ¦‚å¿µï¼šæ ·æœ¬å›å½’ä¸æ€»ä½“å›å½’çš„æ¯”è¾ƒ

```{r}
include_graphics("../pic/extra/chpt2-1-PRL-SRL.png", dpi=120)
```

--

ä¸ºä½•ä¸åŒï¼Ÿç»§æ‰¿æ€§å’Œå˜å¼‚æ€§


---

## é‡è¦æ¦‚å¿µï¼šæ ·æœ¬å›å½’ä¸æ€»ä½“å›å½’çš„æ¯”è¾ƒ

.pull-left[
æ€»ä½“å›å½’å‡½æ•°PRF:

$$\begin{align}
E(Y|X_i) &= \beta_1 +\beta_2X_i && \text{(PRF)}
\end{align}$$

æ€»ä½“å›å½’æ¨¡å‹PRM:

$$\begin{align}
Y_i &=  \beta_1 +\beta_2X_i + u_i && \text{(PRM)}
\end{align}$$

]


.pull-right[
æ ·æœ¬å›å½’å‡½æ•°SRF:

$$\begin{align}
\hat{Y}_i =\hat{\beta}_1 + \hat{\beta}_2X_i && \text{(SRF)}
\end{align}$$

æ ·æœ¬å›å½’æ¨¡å‹SRM:

$$\begin{align}
Y_i &= \hat{\beta}_1 + \hat{\beta}_2X_i +e_i && \text{(SRM)}
\end{align}$$

]

--

æ€è€ƒï¼š

- PRFæ— æ³•ç›´æ¥è§‚æµ‹ï¼Œåªèƒ½ç”¨SRFè¿‘ä¼¼æ›¿ä»£

- ä¼°è®¡å€¼ä¸è§‚æµ‹å€¼ä¹‹é—´å­˜åœ¨åå·®

- SRFåˆæ˜¯æ€æ ·å†³å®šçš„å‘¢?


---

## é‡è¦æ¦‚å¿µï¼šæ ·æœ¬å›å½’ä¸æ€»ä½“å›å½’çš„æ¯”è¾ƒ


æ€»ç»“ï¼š

- éšæœºæŠ½æ ·æ•°æ®ç»§æ‰¿äº†æ€»ä½“çš„ç‰¹å¾ã€‚

- åˆ©ç”¨éšæœºæ ·æœ¬è¿›è¡Œæ•°æ®æ‹Ÿåˆæ˜¯å¯¹æ€»ä½“è§„å¾‹çš„â€œåå‘è¿½è¸ªâ€ã€‚

- æ ·æœ¬å›å½’æ¨¡å‹ä¸­çš„æ®‹å·®æ˜¯æ‹Ÿåˆä¸å®Œå…¨çš„äº§ç‰©ã€‚

--

æ€è€ƒï¼š

- æ€æ ·æ¥åˆ¤å®šå¯¹éšæœºæ ·æœ¬çš„ä¸€æ¬¡æ•°æ®æ‹Ÿåˆæ˜¯æ›´ä¼˜çš„ï¼Ÿ

- å­˜ä¸å­˜åœ¨ä¸€ç§â€œæœ€ä¼˜â€çš„æ‹Ÿåˆæ–¹æ³•ï¼Ÿ

--

è¯¾åä½œä¸šï¼š

- è¯·æŠŠ162ååŒå­¦çš„æ‹Ÿåˆçº¿è¿›è¡Œå¹³å‡åŒ–å¤„ç†ï¼ˆæˆªè·å’Œæ–œç‡å–å‡å€¼ï¼‰ï¼Œç»˜åˆ¶å¾—åˆ°ä¸€æ¡â€œå›å½’çº¿â€ã€‚

- ä½ è®¤ä¸ºæ˜¯è¿™æ ¹å¹³å‡åŒ–çš„â€œå›å½’çº¿â€ä¸çœŸç›¸æ›´é€¼è¿‘ä¹ˆï¼Ÿ

---
layout:false
background-image: url("../pic/thank-you-gif-funny-fan.gif")
class: inverse,center
# æœ¬èŠ‚ç»“æŸ
