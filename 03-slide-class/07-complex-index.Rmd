---
params:
  hideslide: FALSE
output:
  xaringan::moon_reader:
    seal: false
    lib_dir: libs
    css:
      - default
      - ../mycss/my-theme.css 
      - ../mycss/my-font.css
      - ../mycss/my-custom-for-video-roomy.css
      - ../mycss/text-box.css
      - duke-blue
      - hygge-duke
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
---
background-image: url("../pic/slide-front-page.jpg")
class: center,middle
exclude: `r params$hideslide`

# 统计学原理(Statistic)

<!---    chakra: libs/remark-latest.min.js --->

### 胡华平

### 西北农林科技大学

### 经济管理学院数量经济教研室

### huhuaping01@hotmail.com

### `r Sys.Date()`

```{r , echo=F,message=FALSE,warning=F, eval=!params$hideslide}
source("../R/set-global.R")
source("../R/xfun.R", encoding = "UTF-8")
source("../R/external-math-equation.R")
options(width = 70)
#source("../R/xaringan-chromote-print.R")
```


```{r , echo=FALSE, eval=!params$hideslide}
require('xaringanExtra')

xaringanExtra::use_tachyons()

xaringanExtra::use_panelset()

xaringanExtra::use_logo(
  image_url = "../pic/logo/nwafu-logo-circle-wb.png",
  height = '70px',
  position = xaringanExtra::css_position(top='0.2em',left="1em")
)
```

---

class: center, middle, duke-orange,hide_logo
name: chapter
exclude: `r params$hideslide`

# 第七章 指数

### [7.1 基本概述](#index-principal)

### [7.2 总指数编制方法](#index-make)

### [7.3 指数体系](#index-system)

### [7.4 几种典型的指数](#index-life)


---
layout: false
class: center, middle, duke-softblue,hide_logo
name: index-principal

# 7.1 基本概述

### 指数概念

### 指数分类

### 指数编制中的问题

---
layout: true

<div class="my-header-h2"></div>

<div class="watermark1"></div>

<div class="watermark2"></div>

<div class="watermark3"></div>

<div class="my-footer"><span>huhuaping@  &emsp;&emsp; <a href="#chapter"> 第07章 指数 </a>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
<a href="#index-principal"> 7.1 基本问题 </a> </span></div>

---

## 指数概念：含义

**指数(index number)**：最早起源于测量物价的变动，是测定多项内容数量综合变动的相对数。

- 指数的实质是测定多项内容。

> 例如，零售价格指数反映的是零售市场几百万种商品价格变化的整体状况

- 指数的表现形式为动态相对数。

> 既然是动态相对数，就涉及到指标的基期对比，不同要素基期的选择就成为指数方法需要讨论的问题。

编制指数的方法就是围绕上述两个问题展开的 

---

## 指数分类A

按考察对象可以分为:

- **个体指数**：反映单一项目的变量变动。

> 如一种商品的价格或销售量的变动

- **总指数**：反映多个项目变量的综合变动。

> 如多种商品的价格或销售量的综合变动

---

## 指数分类B

按计算形式可以分为:

- **简单指数(simple index number)**：计入指数的各个项目的重要性视为相同。

- **加权指数(weighted index number)**：计入指数的项目依据重要程度赋予不同的权数

---

## 指数分类C

按指标性质可以分为:

- **数量指数**：反映物量变动水平。

> 如产品产量指数、商品销售量指数等

- **质量指数**:反映事物内含数量的变动水平。

> 如价格指数、产品成本指数等


---
layout: false
class: center, middle, duke-softblue,hide_logo
name: index-make

# 7.2 总指数编制方法

### 简单指数

### 加权指数


---
layout: true

<div class="my-header-h2"></div>

<div class="watermark1"></div>

<div class="watermark2"></div>

<div class="watermark3"></div>

<div class="my-footer"><span>huhuaping@  &emsp;&emsp; <a href="#chapter"> 第07章 指数 </a>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
<a href="#index-make"> 7.2 总指数编制方法 </a> </span></div>

---

## 指数编制中的问题

- 选择项目：选择代表规格品

- 确定权数：利用已有的信息构造权数；主观权数

- 计算方法：确定适当的方法

---

## 简单指数

- **简单综合指数**


$$\begin{align}
I_{p}=\frac{\sum p_{1}}{\sum p_{0}}; \quad 
I_{q}=\frac{\sum q_{1}}{\sum q_{0}}
\end{align}$$

- **简单平均指数**


$$\begin{align}
I_{p}=\frac{\sum \frac{p_{1}}{p_{0}}}{n}; \quad I_{q}=\frac{\sum \frac{q_{1}}{q_{0}}}{n}
\end{align}$$

---

## 加权指数：同度量因素

**同度量因素**”：指把不能相加的指标过渡为可以相加的因素。

> 例如，社会商品零售价格总指数，单价不能简单相加，以商品销售量为同度量因素，过渡为商品销售额。

**同度量因素**”作用：

- 同度量作用

- 权数作用

$$\begin{align}
商品销售额 & =商品销售量 \times 价格 \\
工业总产值&=工业总产量\times 价格
\end{align}$$

---

## 加权指数：同度量因素

“同度量因素”的确定，可以通过如下方法：

1.根据现象之间的联系确定同度量因素

- 计算数量指数时，应以相应的质量为同度量因素

- 计算质量指数时，应以相应的物量为同度量因素

2.确定同度量因素的所属时期

- 可以都是基期，也可以都是报告期

- 使用不同时期的同度量因素，计算结果和意义不同

- 取决于计算指数的预期目的

---

## 加权指数

**加权综合指数**(weighted aggregative index number)：是通过加权来测定一组项目的综合变动。

根据权数不同，有不同的计算公式：

- **拉氏指数**(Laspeyres index)：数量指数和质量指数

- **帕氏指数**(Paasche Laspeyres index)：数量指数和质量指数

---

## 加权指数：拉氏综合指数

**拉氏综合指数**：1864年德国学者拉斯贝尔斯(Laspeyres)提出的一种价格指数计算方法。

该方法在计算一组商品综合指数时，把**权数**固定在**基期**（0期）。

具体计算公式为：

.pull-left[
- .red[拉氏]**数量指数**：
.large[
$I_{q(L)}=\frac{\sum\limits_{i=1}^n q_{1i} p_{0i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}$
]
]

.pull-right[

- .red[拉氏]**质量指数**：
.large[
$I_{{p(L)}}=\frac{\sum\limits_{i=1}^n q_{0i} p_{1i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}$

]
]

> 其中：
- 
$I_q$代表数量指数；
$I_p$代表质量指数；
$(L)$代表拉氏计算方法。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。

---
exclude: true

## 指数计算案例

```{r}
source("Rscript/case-index.R", encoding = "UTF-8")
```

---

### （案例）企业产品综合指数

**案例说明**：某企业生产三种不同的产品，报告期和基期的产量和出厂价格如下表所示。

```{r}
names_eng <- c("prod", "unit","q_0", "q_1", "p_0", "p_1")
names_chn <- c("产品名称", "单位",
               "产量\\(q_0\\)","产量\\(q_1\\)",
               "价格\\(p_0\\)","价格\\(p_1\\)")
df_index %>%
  rename_at(vars(names(.)), ~all_of(names_chn)) %>%
  kable(escape = T,
        format.args = list(big.mark = ","),
        caption = "企业生产信息表")
```

请使用拉氏公式分别计算该企业总产值的数量指数
$I_q$和质量指数
$I_p$？

---

### （案例）企业产品综合指数：拉氏数量指数

```{r, warning=FALSE}
names_eng <- c("prod", "unit","q_0", "q_1", "p_0", "p_1",
               "q1p0","q0p0")
names_chn <- c("产品名称", "单位",
               "产量\\(q_0\\)","产量\\(q_1\\)",
               "价格\\(p_0\\)","价格\\(p_1\\)",
               "\\(q_1p_0\\)","\\(q_0p_0\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","),
        caption = "拉氏数量指数计算表")
```

根据拉氏**数量**综合指数的计算方法，以及上述计算表，可得到：

$$\begin{align}
I_{q(L)} =\frac{\sum\limits_{i=1}^n q_{1i} p_{0i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}
 =\frac{`r sum_10`}{`r sum_00`} 
 = `r num_round(I_qL)`
 = `r round(100*I_qL,2)` \%
\end{align}$$

因为产品产量增加，使得产值增加了`r scales::percent(I_qL,accuracy = 0.01)`，实现了产值增加额
$\Delta_q(L) = `r sum_10`-`r sum_00`=`r sum_10-sum_00`$

---

### （案例）企业产品综合指数：拉氏质量指数

```{r}
names_eng <- c("prod", "unit","q_0", "q_1", "p_0", "p_1",
               "q0p1","q0p0")
names_chn <- c("产品名称", "单位",
               "产量\\(q_0\\)","产量\\(q_1\\)",
               "价格\\(p_0\\)","价格\\(p_1\\)",
               "\\(q_0p_1\\)","\\(q_0p_0\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","),
        caption = "拉氏质量指数计算表")
```

根据拉氏**质量**综合指数的计算方法，以及上述计算表，可得到：

$$\begin{align}
I_{{p(L)}}=\frac{\sum\limits_{i=1}^n q_{0i} p_{1i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}
 =\frac{`r sum_01`}{`r sum_00`} 
 = `r num_round(I_pL)`
 = `r round(100*I_pL,2)` \%
\end{align}$$

因为产品出厂价格变动，使得产值增加了`r scales::percent(I_pL,accuracy = 0.01)`，实现了产值增加额
$\Delta_p(L) = `r sum_01`-`r sum_00`=`r sum_01-sum_00`$

---

## 加权指数：帕氏综合指数

**拉氏综合指数**：1874年德国学者帕煦(Pasche)所提出一种指数计算方法。

该方法在计算一组商品综合指数时，把**权数**固定在**报告期**（1期）。

具体计算公式为：

.pull-left[
- .red[帕氏]**数量指数**：
.large[
$I_{q(P)}=\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{0i} p_{1i}}$
]
]

.pull-right[

- .red[帕氏]**质量指数**：
.large[
$I_{{p(P)}}=\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{1i} p_{0i}}$

]
]

> 其中：
- 
$I_q$代表数量指数；
$I_p$代表质量指数；
$(P)$代表拉氏计算方法。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。

---

### （案例）企业产品综合指数：帕氏数量指数

```{r}
names_eng <- c("prod", "unit","q_0", "q_1", "p_0", "p_1",
               "q1p1","q0p1")
names_chn <- c("产品名称", "单位",
               "产量\\(q_0\\)","产量\\(q_1\\)",
               "价格\\(p_0\\)","价格\\(p_1\\)",
               "\\(q_1p_1\\)","\\(q_0p_1\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","),
        caption = "帕氏数量指数计算表")
```

根据帕氏**数量**综合指数的计算方法，以及上述计算表，可得到：

$$\begin{align}
I_{q(P)} =\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{0i} p_{1i}}
 =\frac{`r sum_11`}{`r sum_01`} 
 = `r num_round(I_qP)`
 = `r round(100*I_qP,2)` \%
\end{align}$$

因为产品产量增加，使得产值增加了`r scales::percent(I_qP,accuracy = 0.01)`，实现了产值增加额
$\Delta_q(P) = `r sum_11`-`r sum_01`=`r sum_11-sum_01`$

---

### （案例）企业产品综合指数：帕氏质量指数

```{r}
names_eng <- c("prod", "unit","q_0", "q_1", "p_0", "p_1",
               "q1p1","q1p0")
names_chn <- c("产品名称", "单位",
               "产量\\(q_0\\)","产量\\(q_1\\)",
               "价格\\(p_0\\)","价格\\(p_1\\)",
               "\\(q_1p_1\\)","\\(q_1p_0\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","),
        caption = "帕氏质量指数计算表")
```

根据帕氏**质量**综合指数的计算方法，以及上述计算表，可得到：

$$\begin{align}
I_{{p(P)}}=\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{1i} p_{0i}}
 =\frac{`r sum_11`}{`r sum_10`} 
 = `r num_round(I_pP)`
 = `r round(100*I_pP,2)` \%
\end{align}$$

因为产品出厂价格变动，使得产值增加了`r scales::percent(I_pP,accuracy = 0.01)`，实现了产值增加额
$\Delta_p(L) = `r sum_11`-`r sum_10`=`r sum_11-sum_10`$

---

## 加权指数：拉氏和帕氏指数对比

.pull-left[
.bg-lightest-blue[

.red[拉氏]**数量指数**：
$I_{q(L)}=\frac{\sum\limits_{i=1}^n q_{1i} p_{0i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}$

.red[拉氏]**质量指数**：
$I_{{p(L)}}=\frac{\sum\limits_{i=1}^n q_{0i} p_{1i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}$

]
]

.pull-right[

.bg-light-green[
.purple[帕氏]**数量指数**：
$I_{q(P)}=\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{0i} p_{1i}}$

.purple[帕氏]**质量指数**：
$I_{p(P)}=\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{1i} p_{0i}}$

]

]


---

## 加权指数：加权平均指数

**加权平均指数**：是指以某一时期的总量指标为权数对**个体指数**进行加权平均得到的相对数。具体又分为**加权算数平均指数**和**加权调和平均指数**。

- **个体指数**：包括个体数量指数
$k_q(i) = \frac{q_{1i}}{q_{0i}}$；以及个体质量指数
$k_p(i) = \frac{p_{1i}}{p_{0i}}$。

- **加权数**：

```{block, type = "fyi", echo = T}

A.加权数通常是两个有内在联系变量间的乘积。例如：

- 商品销售额(销售价格与销售量的乘积)；

- 农产品总产量(单位面积产量与收获面积的乘积)


B.加权数可以是同期变量的乘积，也可以混合时期变量的乘积：

- 
$f_{00}=q_{0i}p_{0i}; \quad f_{11}=q_{1i}p_{1i}$

- 
$f_{01}=q_{0i}p_{1i}; \quad f_{10}=q_{1i}p_{0i}$

```


---

## 加权指数：加权算数平均指数A（拉氏数量）

.pull-left[ .large[
.bg-light-green[
$$\begin{aligned}
\boldsymbol{I}_{\boldsymbol{q}(L)}  &=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{q}_{1i}}{\boldsymbol{q}_{0i}}\right) \cdot\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)\right]}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{k}_{q_i} \cdot \boldsymbol{f}_{00}\right)}{\sum\limits_{i=1}^n \boldsymbol{f}_{00}} 
=\boldsymbol{A}_{q(L)} 
\end{aligned}$$
]
]
]

.pull-right[


> ![](../mycss/img/face-smile.jpg)其中：
- 
$A_q$代表加权算数平均数量指数；
$A_p$代表加权算数平均质量指数；
$(L)$代表拉氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 
$\boldsymbol{f}_{00}=q_{0i}p_{0i}$表示权重
]

---

## 加权指数：加权算数平均指数B（拉氏质量）

.pull-left[
.bg-lightest-blue[ .large[
$$\begin{aligned}
\boldsymbol{I}_{\boldsymbol{p}(L)}  &=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{p}_{1i}}{\boldsymbol{p}_{0i}}\right) \cdot\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)\right]}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{k}_{p_i} \cdot \boldsymbol{f}_{00}\right)}{\sum\limits_{i=1}^n \boldsymbol{f}_{00}} 
=\boldsymbol{A}_{p(L)} 
\end{aligned}$$
]
]
]

.pull-right[

> ![](../mycss/img/face-normal.jpg)其中：
- 
$A_q$代表加权算数平均数量指数；
$A_p$代表加权算数平均质量指数；
$(L)$代表拉氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 
$\boldsymbol{f}_{00}=q_{0i}p_{0i}$表示权重
]

---

## 加权指数：加权算数平均指数C（帕氏数量）

.pull-left[ .large[
.bg-light-yellow[
$$\begin{aligned}
\boldsymbol{I}_{\boldsymbol{q(P)}}  &=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{q}_{1i}}{\boldsymbol{q}_{\boldsymbol{0i}}}\right) \cdot\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)\right]}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{k}_{q_i} \cdot \boldsymbol{f}_{\text {01}}\right)}{\sum\limits_{i=1}^n \boldsymbol{f}_{01}} =\boldsymbol{A}_{\boldsymbol{q(P)}} 
\end{aligned}$$
]
]
]

.pull-right[

> ![](../mycss/img/face-cry.jpg)其中：
- 
$A_q$代表加权算数平均数量指数；
$A_p$代表加权算数平均质量指数；
$(P)$代表帕氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 
$\boldsymbol{f}_{01}=q_{0i}p_{1i}$表示权重
]

---

## 加权指数：加权算数平均指数D（帕氏质量）

.pull-left[ .large[
.bg-light-pink[
$$\begin{aligned}
\boldsymbol{I}_{\boldsymbol{p(P)}}  &=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{p}_{1i}}{\boldsymbol{p}_{\boldsymbol{0i}}}\right) \cdot\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)\right]}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{k}_{p_i} \cdot \boldsymbol{f}_{10}\right)}{\sum \boldsymbol{f}_{10}}
=\boldsymbol{A}_{\boldsymbol{p(P)}} 
\end{aligned}$$
]
]
]

.pull-right[

> ![](../mycss/img/face-normal.jpg)其中：
- 
$A_q$代表加权算数平均数量指数；
$A_p$代表加权算数平均质量指数；
$(P)$代表帕氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 
$\boldsymbol{f}_{10}=q_{1i}p_{0i}$表示权重
]

---

## 加权指数：加权算数平均指数（小结）

```{r}
smry_index <- tibble(
  cat1 = rep(c("加权算数", "加权调和"), each = 4) ,
  cat2 = rep(c("数量指数", "质量指数"), times =4),
  id = LETTERS[1:8],
  eq =c("\\(A_q(L)\\)", "\\(A_P(L)\\)","\\(A_q(P)\\)","\\(A_p(P)\\)",
        "\\(H_q(L)\\)", "\\(H_P(L)\\)","\\(H_q(P)\\)","\\(H_p(P)\\)"),
  k = rep(c("\\(k_q\\)","\\(k_p\\)"), times = 4),
  f = c("\\(f_{00}\\)", "\\(f_{00}\\)","\\(f_{01}\\)","\\(f_{10}\\)",
        "\\(f_{10}\\)","\\(f_{01}\\)", "\\(f_{11}\\)","\\(f_{11}\\)")
)

```

.large[

```{r}
names_chn <- c("计算类别", "指数类别", "序号", "公式代号",
               "个体指数k", "权重f")
smry_index %>%
  head(4) %>%
  rename_at(all_of(vars(names(.))), ~all_of(names_chn)) %>%
  kable(align="c",
      caption = "基于个体指数计算加权算数平均指数的情形")
```

]

> 其中：
- 
$A_q$代表加权算数平均数量指数；
$A_p$代表加权算数平均质量指数；
$(L)$代表拉氏计算方法；
$(P)$代表帕氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 权重
$\boldsymbol{f}_{00},\boldsymbol{f}_{01},\boldsymbol{f}_{11},\boldsymbol{f}_{10}$。例如
$\boldsymbol{f}_{10}=q_{1i}p_{0i}$。



---

### （案例）情景A：基于个体产量指数计算拉氏数量指数(数据)

**案例A说明**：某企业生产三种不同的产品，基期产值
$q_0p_0$和个体产量指数
$k_q$如下表所示。

```{r}
names_eng <- c("prod", "unit",
               "q0p0","k_q")
names_chn <- c("产品名称", "单位",
               "基期产值\\(q_0p_0\\)","个体产量指数\\(k_q\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_q")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ","),
        caption = "案例情景A（数据表）")
```

请分析并计算由于产品产量变动，带来的企业总产值变动的指数？


---

### （案例）情景A：基于个体产量指数计算拉氏数量指数(解答)

**案例A解答**：因为案例仅仅给出了基期产值
$q_0p_0$和个体产量指数
$k_q$，因此需要使用**拉氏加权算数平均数量指数**公式
$A_q(L)$。

```{r}
names_eng <- c("prod", "unit",
               "q0p0","k_q",
               "aq.L")
names_chn <- c("产品名称", "单位",
               "基期总产值\\(f_{00}=q_0p_0\\)","个体产量指数\\(k_q\\)",
               "\\(k_q*f_{00}\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_q")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ",")
        )
```

--

$$\begin{aligned}
\boldsymbol{A}_{q(L)} 
=\frac{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{q}_{1i}}{\boldsymbol{q}_{0i}}\right) \cdot\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)\right]}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)} 
=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{k}_{q_i} \cdot \boldsymbol{f}_{00}\right)}{\sum\limits_{i=1}^n \boldsymbol{f}_{00}}
= \frac{`r sum_aq.L`}{`r sum_00`}
= `r num_round(I_qL)`
= `r num_round(100*I_qL, digits =2)`\%
\end{aligned}$$

--

因为产品产量增加，使得产值增加了`r scales::percent(I_qL,accuracy = 0.01)`，实现了产值增加额
$\Delta_q(L) = `r sum_10`-`r sum_00`=`r sum_10-sum_00`$

---

### （案例）情景B：基于个体价格指数计算拉氏质量指数(数据)

**案例B说明**：某企业生产三种不同的产品，基期产值
$q_0p_0$和个体价格指数
$k_p$如下表所示。

```{r}
names_eng <- c("prod", "unit",
               "q0p0","k_p")
names_chn <- c("产品名称", "单位",
               "基期产值\\(q_0p_0\\)","个体价格指数\\(k_p\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_p")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ","),
        caption = "案例情景B（数据表）")
```

请分析并计算由于产品价格变动，带来的企业总产值变动的指数？


---

### （案例）情景B：基于个体价格指数计算拉氏质量指数(解答)

**案例B解答**：因为案例仅仅给出了基期产值
$q_0p_0$和个体产量指数
$k_p$，因此需要使用**拉氏加权算数平均质量指数**公式
$A_p(L)$。

```{r}
names_eng <- c("prod", "unit",
               "q0p0","k_p",
               "ap.L")
names_chn <- c("产品名称", "单位",
               "基期产值\\(f_{00}=q_0p_0\\)","个体价格指数\\(k_p\\)",
               "\\(k_p*f_{00}\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_p")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ",")
        )
```

--

$$\begin{aligned}
\boldsymbol{A}_{p(L)} 
=\frac{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{p}_{1i}}{\boldsymbol{p}_{0i}}\right) \cdot\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)\right]}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)} 
=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{k}_{p_i} \cdot \boldsymbol{f}_{00}\right)}{\sum\limits_{i=1}^n \boldsymbol{f}_{00}} 
= \frac{`r sum_ap.L`}{`r sum_00`}
= `r num_round(I_pL)`
= `r num_round(100*I_pL, digits =2)`\%
\end{aligned}$$

--

因为产品出厂价格变动，使得产值增加了`r scales::percent(I_pL,accuracy = 0.01)`，实现了产值增加额
$\Delta_p(L) = `r sum_01`-`r sum_00`=`r sum_01-sum_00`$

---

### （案例）情景C：基于个体产量指数计算帕氏数量指数(数据)

**案例C说明**：某企业生产三种不同的产品，记录了
$q_0p_1$和个体产量指数
$k_q$如下表所示。

```{r}
names_eng <- c("prod", "unit",
               "q0p1","k_q")
names_chn <- c("产品名称", "单位",
               "\\(q_0p_1\\)","个体产量指数\\(k_q\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_q")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ","),
        caption = "案例情景C（数据表）")
```

请分析并计算由于产品产量变动，带来的企业总产值变动的指数？


---

### （案例）情景C：基于个体产量指数计算帕氏数量指数(解答)

**案例C解答**：因为案例仅仅给出了
$q_0p_1$和个体产量指数
$k_q$，因此需要使用**帕氏加权算数平均数量指数**公式
$A_q(P)$。

```{r}
names_eng <- c("prod", "unit",
               "q0p1","k_q",
               "aq.P")
names_chn <- c("产品名称", "单位",
               "\\(f_{01}=q_0p_1\\)","个体产量指数\\(k_q\\)",
               "\\(k_q*f_{01}\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_q")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ",")
        )
```

--

$$\begin{aligned}
\boldsymbol{A}_{\boldsymbol{q(P)}} =\frac{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{q}_{1i}}{\boldsymbol{q}_{\boldsymbol{0i}}}\right) \cdot\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)\right]}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)} 
=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{k}_{q_i} \cdot \boldsymbol{f}_{\text {01}}\right)}{\sum\limits_{i=1}^n \boldsymbol{f}_{01}}
= \frac{`r sum_aq.P`}{`r sum_01`}
= `r num_round(I_qP)`
= `r num_round(100*I_qP, digits =2)`\%
\end{aligned}$$

--

因为产品产量增加，使得产值增加了`r scales::percent(I_qP,accuracy = 0.01)`，实现了产值增加额
$\Delta_q(P) = `r sum_11`-`r sum_01`=`r sum_11-sum_01`$

---

### （案例）情景D：基于个体价格指数计算帕氏数量指数(数据)

**案例D说明**：某企业生产三种不同的产品，以及
$q_1p_0$和个体价格指数
$k_p$如下表所示。

```{r}
names_eng <- c("prod", "unit",
               "q1p0","k_p")
names_chn <- c("产品名称", "单位",
               "\\(q_1p_0\\)","个体价格指数\\(k_p\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_p")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ","),
        caption = "案例情景D（数据表）")
```

请分析并计算由于产品价格变动，带来的企业总产值变动的指数？


---

### （案例）情景D：基于个体价格指数计算帕氏数量指数(解答)

**案例D解答**：因为案例仅仅给出了
$q_1p_0$和个体产量指数
$k_p$，因此需要使用**帕氏加权算数平均质量指数**公式
$A_p(P)$。

```{r}
names_eng <- c("prod", "unit",
               "q1p0","k_p",
               "ap.P")
names_chn <- c("产品名称", "单位",
               "\\(f_{10}=q_1p_0\\)","个体价格指数\\(k_p\\)",
               "\\(k_p*f_{10}\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_p")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ",")
        )
```

--

$$\begin{aligned}
\boldsymbol{A}_{\boldsymbol{p(P)}} 
=\frac{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{p}_{1i}}{\boldsymbol{p}_{\boldsymbol{0i}}}\right) \cdot\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)\right]}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)} 
=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{k}_{p_i} \cdot \boldsymbol{f}_{10}\right)}{\sum \boldsymbol{f}_{10}}
= \frac{`r sum_ap.P`}{`r sum_10`}
= `r num_round(I_pP)`
= `r num_round(100*I_pP, digits =2)`\%
\end{aligned}$$

--

因为产品出厂价格变动，使得产值增加了`r scales::percent(I_pP,accuracy = 0.01)`，实现了产值增加额
$\Delta_p(P) = `r sum_11`-`r sum_10`=`r sum_11-sum_10`$

---

## 加权指数：加权调和平均指数E（拉氏数量）

.pull-left[ .large[
.bg-light-yellow[
$$\begin{aligned}
\boldsymbol{I}_{\boldsymbol{q}(L)}  &=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)}{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{q}_{0i}}{\boldsymbol{q}_{1i}}\right) \cdot\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)\right]} \\
&=\frac{\sum\limits_{i=1}^n \boldsymbol{f}_{10}}{\sum\limits_{i=1}^n\left(\frac{1}{\boldsymbol{k}_{q_i}} \cdot \boldsymbol{f}_{10}\right)} 
=\boldsymbol{H}_{q(L)} 
\end{aligned}$$
]
]
]

.pull-right[

> ![](../mycss/img/face-normal.jpg)其中：
- 
$H_q$代表加权调和平均数量指数；
$H_p$代表加权调和平均质量指数；
$(L)$代表拉氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 
$\boldsymbol{f}_{10}=q_{1i}p_{0i}$表示权重
]

---

## 加权指数：加权调和平均指数F（拉氏质量）

.pull-left[
.bg-light-pink[ .large[
$$\begin{aligned}
\boldsymbol{I}_{\boldsymbol{p}(L)}  &=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{p}_{0i}}{\boldsymbol{p}_{1i}}\right) \cdot\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)\right]} \\
&=\frac{\sum\limits_{i=1}^n \boldsymbol{f}_{01}}{\sum\limits_{i=1}^n\left(\frac{1}{\boldsymbol{k}_{p_i}} \cdot \boldsymbol{f}_{01}\right)} 
=\boldsymbol{H}_{p(L)} 
\end{aligned}$$
]
]
]

.pull-right[

> ![](../mycss/img/face-cry.jpg)其中：
- 
$H_q$代表加权算数平均数量指数；
$H_p$代表加权算数平均质量指数；
$(L)$代表拉氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 
$\boldsymbol{f}_{10}=q_{0i}p_{1i}$表示权重
]

---

## 加权指数：加权调和平均指数G（帕氏数量）

.pull-left[ .large[
.bg-light-yellow[
$$\begin{aligned}
\boldsymbol{I}_{\boldsymbol{q(P)}}  &=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{q}_{0i}}{\boldsymbol{q}_{\boldsymbol{1i}}}\right) \cdot\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)\right]} \\
&=\frac{\sum\limits_{i=1}^n \boldsymbol{f}_{11}}{\sum\limits_{i=1}^n\left(\frac{1}{\boldsymbol{k}_{q_i}} \cdot \boldsymbol{f}_{11}\right)} 
=\boldsymbol{A}_{\boldsymbol{q(P)}} 
\end{aligned}$$
]
]
]

.pull-right[

> ![](../mycss/img/face-normal.jpg)其中：
- 
$H_q$代表加权算数平均数量指数；
$H_p$代表加权算数平均质量指数；
$(P)$代表帕氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 
$\boldsymbol{f}_{11}=q_{1i}p_{1i}$表示权重
]

---

## 加权指数：加权调和平均指数H（帕氏质量）

.pull-left[ .large[
.bg-light-green[
$$\begin{aligned}
\boldsymbol{I}_{\boldsymbol{p(P)}}  &=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)} \\
&=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{p}_{0i}}{\boldsymbol{p}_{\boldsymbol{1i}}}\right) \cdot\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)\right]} \\
&=\frac{\sum \boldsymbol{f}_{11}}{\sum\limits_{i=1}^n\left(\frac{1}{\boldsymbol{k}_{p_i}} \cdot \boldsymbol{f}_{11}\right)}
=\boldsymbol{H}_{\boldsymbol{p(P)}} 
\end{aligned}$$
]
]
]

.pull-right[

> ![](../mycss/img/face-smile.jpg)其中：
- 
$H_q$代表加权调和平均数量指数；
$H_p$代表加权调和平均质量指数；
$(P)$代表帕氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 
$\boldsymbol{f}_{11}=q_{1i}p_{1i}$表示权重
]

---

## 加权指数：加权调和平均指数（小结）

.large[

```{r}
names_chn <- c("计算类别", "指数类别", "序号", "公式代号",
               "个体指数k", "权重f")
smry_index %>%
  tail(4) %>%
  rename_at(all_of(vars(names(.))), ~all_of(names_chn)) %>%
  kable(align="c",
      caption = "基于个体指数计算加权调和平均指数的情形")
```

]

> 其中：
- 
$H_q$代表加权调和平均数量指数；
$H_p$代表加权调和平均质量指数；
$(L)$代表拉氏计算方法；
$(P)$代表帕氏计算方法。
- 
$k_q$表示个体数量指数；
$k_p$表示个体质量指数。
- 
$0$表示基期水平；
$1$表示报告期水平；
$i \in (1, 2, \cdots, n)$表示商品。
- 权重
$\boldsymbol{f}_{00},\boldsymbol{f}_{01},\boldsymbol{f}_{11},\boldsymbol{f}_{10}$。例如
$\boldsymbol{f}_{10}=q_{1i}p_{0i}$。

---

### （案例）情景E：基于个体产量指数计算拉氏数量指数(数据)

**案例E说明**：某企业生产三种不同的产品，并记录了
$q_1p_0$和个体产量指数
$k_q$如下表所示。

```{r}
names_eng <- c("prod", "unit",
               "q1p0","k_q")
names_chn <- c("产品名称", "单位",
               "\\(q_1p_0\\)","个体产量指数\\(k_q\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_q")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ","),
        caption = "案例情景E（数据表）")
```

请分析并计算由于产品产量变动，带来的企业总产值变动的指数？

---

### （案例）情景E：基于个体产量指数计算拉氏数量指数(解答)

**案例E解答**：因为案例仅仅给出了报告期产值
$q_1p_0$和个体产量指数
$k_q$，因此需要使用**拉氏调和算数平均数量指数**公式
$H_q(L)$。

```{r}
names_eng <- c("prod", "unit",
               "q1p0","k_q",
               "hq.L")
names_chn <- c("产品名称", "单位",
               "\\(f_{10}=q_1p_0\\)","个体产量指数\\(k_q\\)",
               "\\(f_{10}/k_q\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_q")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ",")
        )
```

--

$$\begin{aligned}
\boldsymbol{H}_{q(L)}  
= \frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)}{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{q}_{0i}}{\boldsymbol{q}_{1i}}\right) \cdot\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{0i}\right)\right]} 
=\frac{\sum\limits_{i=1}^n \boldsymbol{f}_{10}}{\sum\limits_{i=1}^n\left(\frac{1}{\boldsymbol{k}_{q_i}} \cdot \boldsymbol{f}_{10}\right)} 
= \frac{`r sum_10`}{`r sum_hq.L`}
= `r num_round(I_qL)`
= `r num_round(100*I_qL, digits =2)`\%
\end{aligned}$$

--

因为产品产量增加，使得产值增加了`r scales::percent(I_qL,accuracy = 0.01)`，实现了产值增加额
$\Delta_q(L) = `r sum_10`-`r sum_00`=`r sum_10-sum_00`$

---

### （案例）情景F：基于个体价格指数计算拉氏质量指数(数据)

**案例F说明**：某企业生产三种不同的产品，并记录了
$q_0p_1$和个体价格指数
$k_p$如下表所示。

```{r}
names_eng <- c("prod", "unit",
               "q0p1","k_p")
names_chn <- c("产品名称", "单位",
               "\\(q_0p_1\\)","个体价格指数\\(k_p\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_p")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ","),
        caption = "案例情景F（数据表）")
```

请分析并计算由于产品价格变动，带来的企业总产值变动的指数？


---

### （案例）情景F：基于个体价格指数计算拉氏质量指数(解答)

**案例F解答**：因为案例仅仅给出了报告期产值
$q_0p_1$和个体产量指数
$k_p$，因此需要使用**拉氏加权算数平均质量指数**公式
$A_p(L)$。

```{r}
names_eng <- c("prod", "unit",
               "q0p1","k_p",
               "hp.L")
names_chn <- c("产品名称", "单位",
               "\\(f_{01}=q_0p_1\\)","个体价格指数\\(k_p\\)",
               "\\(f_{01}/k_p\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_p")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ",")
        )
```

--

$$\begin{aligned}
\boldsymbol{H}_{p(L)} 
=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{p}_{0i}}{\boldsymbol{p}_{1i}}\right) \cdot\left(\boldsymbol{q}_{0i} \boldsymbol{p}_{1i}\right)\right]} =\frac{\sum\limits_{i=1}^n \boldsymbol{f}_{01}}{\sum\limits_{i=1}^n\left(\frac{1}{\boldsymbol{k}_{p_i}} \cdot \boldsymbol{f}_{01}\right)} 
= \frac{`r sum_01`}{`r sum_hp.L`}
= `r num_round(I_pL)`
= `r num_round(100*I_pL, digits =2)`\%
\end{aligned}$$

--

因为产品出厂价格变动，使得产值增加了`r scales::percent(I_pL,accuracy = 0.01)`，实现了产值增加额
$\Delta_p(L) = `r sum_01`-`r sum_00`=`r sum_01-sum_00`$

---

### （案例）情景G：基于个体产量指数计算帕氏数量指数(数据)

**案例G说明**：某企业生产三种不同的产品，记录了
$q_1p_1$和个体产量指数
$k_q$如下表所示。

```{r}
names_eng <- c("prod", "unit",
               "q1p1","k_q")
names_chn <- c("产品名称", "单位",               "报告期总产值\\(q_1p_1\\)","个体产量指数\\(k_q\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_q")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ","),
        caption = "案例情景G（数据表）")
```

请分析并计算由于产品产量变动，带来的企业总产值变动的指数？


---

### （案例）情景G：基于个体产量指数计算帕氏数量指数(解答)

**案例G解答**：因为案例仅仅给出了
$q_1p_1$和个体产量指数
$k_q$，因此需要使用**帕氏加权调和平均数量指数**公式
$H_q(P)$。

```{r}
names_eng <- c("prod", "unit",
               "q1p1","k_q",
               "hq.P")
names_chn <- c("产品名称", "单位",
               "\\(f_{11}=q_1p_1\\)","个体产量指数\\(k_q\\)",
               "\\(f_{11}/k_q\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_q")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ",")
        )
```

--

$$\begin{aligned}
\boldsymbol{A}_{\boldsymbol{q(P)}} 
=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{q}_{0i}}{\boldsymbol{q}_{\boldsymbol{1i}}}\right) \cdot\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)\right]} 
=\frac{\sum\limits_{i=1}^n \boldsymbol{f}_{11}}{\sum\limits_{i=1}^n\left(\frac{1}{\boldsymbol{k}_{q_i}} \cdot \boldsymbol{f}_{11}\right)} 
= \frac{`r sum_11`}{`r sum_hq.P`}
= `r num_round(I_qP)`
= `r num_round(100*I_qP, digits =2)`\%
\end{aligned}$$

--

因为产品产量增加，使得产值增加了`r scales::percent(I_qP,accuracy = 0.01)`，实现了产值增加额
$\Delta_q(P) = `r sum_11`-`r sum_01`=`r sum_11-sum_01`$

---

### （案例）情景H：基于个体价格指数计算帕氏质量指数(数据)

**案例H说明**：某企业生产三种不同的产品，报告期产值
$q_1p_1$和个体价格指数
$k_p$如下表所示。

```{r}
names_eng <- c("prod", "unit",
               "q1p1","k_p")
names_chn <- c("产品名称", "单位",
               "报告期总产值\\(q_1p_1\\)","个体价格指数\\(k_p\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_p")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ","),
        caption = "案例情景H（数据表）")
```

请分析并计算由于产品价格变动，带来的企业总产值变动的指数？


---

### （案例）情景H：基于个体价格指数计算帕氏质量指数(解答)

**案例H解答**：因为案例仅仅给出了报告期产值
$q_1p_1$和个体产量指数
$k_p$，因此需要使用**帕氏加权调和平均质量指数**公式
$H_p(P)$。

```{r}
names_eng <- c("prod", "unit",
               "q1p1","k_p",
               "hp.P")
names_chn <- c("产品名称", "单位",
               "\\(f_{11}=q_1p_1\\)","个体价格指数\\(k_p\\)",
               "\\(f_{11}/k_p\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  mutate_at(vars(contains("k_p")), funs(num_round(., digits = 2))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        #digits = c(0,0,0,2), 
        format.args = list(big.mark = ",")
        )
```

--

$$\begin{aligned}
\boldsymbol{H}_{\boldsymbol{p(P)}}
=\frac{\sum\limits_{i=1}^n\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)}{\sum\limits_{i=1}^n\left[\left(\frac{\boldsymbol{p}_{0i}}{\boldsymbol{p}_{\boldsymbol{1i}}}\right) \cdot\left(\boldsymbol{q}_{1i} \boldsymbol{p}_{1i}\right)\right]} 
=\frac{\sum \boldsymbol{f}_{11}}{\sum\limits_{i=1}^n\left(\frac{1}{\boldsymbol{k}_{p_i}} \cdot \boldsymbol{f}_{11}\right)}
= \frac{`r sum_11`}{`r sum_hp.P`}
= `r num_round(I_pP)`
= `r num_round(100*I_pP, digits =2)`\%
\end{aligned}$$

--

因为产品出厂价格变动，使得产值增加了`r scales::percent(I_pP,accuracy = 0.01)`，实现了产值增加额
$\Delta_p(P) = `r sum_11`-`r sum_10`=`r sum_11-sum_10`$


---

## 加权指数：公式总结


.large[

```{r}
names_chn <- c("计算类别", "指数类别", "序号", "公式代号",
               "个体指数k", "权重f")
smry_index %>%
  rename_at(all_of(vars(names(.))), ~all_of(names_chn)) %>%
  kable(align="c",
      caption = "基于个体指数计算加权平均指数的情形")
```

]

---
layout: false
class: center, middle, duke-softblue,hide_logo
name: index-system

# 7.3 指数体系

### 概念和应用

### 总量指数体系变动分析

### 平均数指数体系变动分析


---
layout: true

<div class="my-header-h2"></div>

<div class="watermark1"></div>

<div class="watermark2"></div>

<div class="watermark3"></div>

<div class="my-footer"><span>huhuaping@  &emsp;&emsp; <a href="#chapter"> 第07章 指数 </a>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
<a href="#index-system"> 7.3 指数体系 </a> </span></div>

---

## 概念和应用

**指数体系**：统计上把这些互相联系的指数所构成的体系，叫做指数体系。

指数体系的应用：

- 指数体系是因素分析法的基础。

- 利用指数体系，还可进行指数因素之间的互相换算。

```{block, type = "notes", echo=T}
**总变动指数=因素指数的乘积**，例如：

> 
- 商品销售额=商品价格 × 商品销售量
- 生产费用支出额=单位成本 × 产品产量

> 
- 商品销售额指数=商品价格指数 × 商品销售量指数
- 生产费用支出额指数=单位成本指数 × 产品产量指数


```


---

## 总量指数体系变动分析：两因素分析

两因素的**相对数**关系分析：

$$\begin{align}
K_{qp} &= K_q \times K_p \\
K_{qp} &= I_{q(L)} \times I_{p(P)} \\
\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}
&=\frac{\sum\limits_{i=1}^n q_{1i} p_{0i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}
\times 
\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{1i} p_{0i}}
\end{align}$$

两因素的**绝对额**关系分析：

$$\begin{align}
\left({\sum\limits_{i=1}^n q_{1i}p_{1i}}-{\sum\limits_{i=1}^n q_{0i} p_{0i}} \right)
=\left({\sum\limits_{i=1}^n q_{1i} p_{0i}} - {\sum\limits_{i=1}^n q_{0i} p_{0i}} \right) + \left({\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{1i} p_{0i}} \right)
\end{align}$$

---

### （案例）两因素变动分析：数据表

**案例说明**：某企业生产三种不同的产品，报告期和基期的产量和出厂价格如下表所示。

```{r, warning=FALSE}
names_eng <- c("prod", "unit","q_0", "q_1", "p_0", "p_1")
names_chn <- c("产品名称", "单位",
               "产量\\(q_0\\)","产量\\(q_1\\)",
               "价格\\(p_0\\)","价格\\(p_1\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","),
        caption = "案例数据表")
```

请合理使用指数公式，对总产值变动进行两因素（产量和出厂价格）的变动分析。

---

### （案例）两因素变动分析：解答

根据前述数据表，我们可以得到如下计算表：

```{r, warning=FALSE}
names_eng <- c("prod", "unit","q_0", "q_1", "p_0", "p_1",
               "q1p1","q0p0","q1p0","q0p1")
names_chn <- c("产品", "单位",
               "产量\\(q_0\\)","产量\\(q_1\\)",
               "价格\\(p_0\\)","价格\\(p_1\\)",
               "\\(q_1p_1\\)","\\(q_0p_0\\)",
               "\\(q_1p_0\\)","\\(q_0p_1\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","))
```

---

### （案例）两因素变动分析：相对数分析

两因素的**相对数**关系分析中，我们将使用拉氏数量指数+帕氏质量指数分别进行产量和价格变动分析：

步骤1：确定分解公式

$$\begin{align}
K_{qp} &= K_q \times K_p \\
K_{qp} &= I_{q(L)} \times I_{p(P)} 
\end{align}$$

---

### （案例）两因素变动分析：相对数分析

步骤2：计算总指数和分解指数

$$\begin{align}
K_{qp} = \frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}} 
 =\frac{`r sum_11`}{`r sum_00`}
= `r num_round(K)`
 = `r num_round(100*K, digits=2)`\%\\
\end{align}$$

$$\begin{align}
I_{q(L)}=\frac{\sum\limits_{i=1}^n q_{1i} p_{0i}}{\sum\limits_{i=1}^n q_{0i} p_{0i}}
=\frac{`r sum_10`}{`r sum_00`}
=`r num_round(I_qL)`
=`r num_round(100*I_qL, digits=2)`\%
\end{align}$$

$$\begin{align}
I_{p(P)}=
\frac{\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{1i} p_{0i}}
=\frac{`r sum_11`}{`r sum_10`} 
=`r num_round(I_pP)`
=`r num_round(100*I_pP, digits=2)`\%
\end{align}$$

---

### （案例）两因素变动分析：相对数分析

步骤3：相对数变动分解

$$\begin{align}
K_{qp} &= I_{q(L)} \times I_{p(P)}  \\
`r num_round(100*K, digits=2)`\% &= `r num_round(100*I_qL, digits=2)`\% \times 
`r num_round(100*I_pP, digits=2)`\%
\end{align}$$

---

### （案例）两因素变动分析：绝对数分析

步骤4：与之相对应，两因素的**绝对额**关系分析结果如下：

$$\begin{align}
\left({\sum\limits_{i=1}^n q_{1i}p_{1i}}-{\sum\limits_{i=1}^n q_{0i} p_{0i}} \right)
&=\left({\sum\limits_{i=1}^n q_{1i} p_{0i}} - {\sum\limits_{i=1}^n q_{0i} p_{0i}} \right) + \left({\sum\limits_{i=1}^n q_{1i} p_{1i}}{\sum\limits_{i=1}^n q_{1i} p_{0i}} \right) \\
\left({`r sum_11`}-{`r sum_00`} \right)
&=\left({`r sum_10`} - {`r sum_00`} \right) + \left({`r sum_11`}-{`r sum_10`} \right) \\
\left({`r sum_11 -sum_00`} \right)
&=\left({`r sum_10 - sum_00`}  \right) + \left({`r sum_11 -sum_10`} \right)
\end{align}$$

总产值变动额为`r sum_11 -sum_00`，其中因为产量因素引起的产值变动额为`r sum_10 -sum_00`，因为出厂价格因素引起的产值变动额为`r sum_11 -sum_10`。

---

## 总量指数体系变动分析：多因素分析

多因素分析体系变动分析的基本原则：

- 把影响复杂总体变动的各个因素，按照数量指标在前，质量指标在后的顺序进行排列。

- 当分析某一因素对复杂总体变动的影响时，未被分析的后面诸因素要固定在基期水平，而已被分析过的前面诸因素，则要固定在报告期水平。

- 两个相邻的指标相乘必须具有实际经济意义


> 初始变量关系：
- 工业产品原材料支出额=单位产品原材料消耗×产品数量×原材料单价

> 经排列后为：
- 工业产品原材料支出额=产品数量q×单耗m×单价p

---

## 总量指数体系变动分析：多因素分析

多因素分析体系变动分析的“连锁替代法”：

> 两因素变量情形：
- 总产值=工人人数×工人劳动生产率

> 多因素变量情形：
- 总产值=(A)工人人数 × (B)时劳动生产率× (C)平均每日工作时长× (D)平均每月工作天数

$$\begin{align}
K_{ABCD} & = K_A *K_B*K_C*K_D \\
\frac{\sum\limits_{i=1}^n{A_{1} B_{1} C_{1} D_{1}}}{\sum\limits_{i=1}^n{A_{0} B_{0} C_{0} D_{0}}}
&=\frac{\sum\limits_{i=1}^n{A_{1} B_{0} C_{0} D_{0}}}{\sum\limits_{i=1}^n{A_{0} B_{0} C_{0} D_{0}}} 
\times \frac{\sum\limits_{i=1}^n{A_{1} B_{1} C_{0} D_{0}}}{\sum\limits_{i=1}^n{A_{1} B_{0} C_{0} D_{0}}} 
\times \frac{\sum\limits_{i=1}^n{A_{1} B_{1} C_{1} D_{0}}}{\sum\limits_{i=1}^n{A_{1} B_{1} C_{0} D_{0}}} 
\times \frac{\sum\limits_{i=1}^n{A_{1} B_{1} C_{1} D_{1}}}{\sum\limits_{i=1}^n{A_{1} B_{1} C_{1} D_{0}}}
\end{align}$$

---
exclude: true

## 案例：三因素分析

```{r}
source("Rscript/case-index-multiple.R", encoding = "UTF-8")
```


---

### （案例）多因素变动分析：数据表

**案例说明**：某企业基期、报告期产量（件）、单耗和单价（元）情况表如下，请对该企业的材料总支出的变动进行多因素分析。 

```{r, warning=FALSE}
names_eng <- c("prod", "unit","q_0", "q_1","m_0", "m_1",  "p_0", "p_1")
names_chn <- c("产品", "单位",
               "产量\\(q_0\\)","产量\\(q_1\\)",
               "单耗\\(m_0\\)","单耗\\(m_1\\)",
               "价格\\(p_0\\)","价格\\(p_1\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","),
        caption = "案例数据表")
```


---

### （案例）多因素变动分析：计算表

根据多因素变动分析“连锁替代”方法，我们可以首先得到如下计算表：

```{r, warning=FALSE}
names_eng <- c("prod", "unit","q_0", "q_1","m_0", "m_1",  "p_0", "p_1",
               "q0m0p0","q1m0p0","q1m1p0","q1m1p1")
names_chn <- c("产品", "单位",
               "\\(q_0\\)","\\(q_1\\)",
               "\\(m_0\\)","\\(m_1\\)",
               "\\(p_0\\)","\\(p_1\\)",
               "\\(q_0m_0p_0\\)", "\\(q_1m_0p_0\\)",
                "\\(q_1m_1p_0\\)", "\\(q_1m_1p_1\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","),
        caption = "案例数据表")
```

---

### （案例）多因素变动分析：确定计算公式

**步骤1**：根据多因素变动分析“连锁替代”公式，建立如下的因素分析指标体系：

$$\begin{align}
K_{qmp} & = K_q *K_m*K_p \\
\frac{\sum\limits_{i=1}^n{q_{1} m_{1} p_{1}}}{\sum\limits_{i=1}^n{q_{0} m_{0} p_{0} }}
&=\frac{\sum\limits_{i=1}^n{q_{1} m_{0} p_{0} }}{\sum\limits_{i=1}^n{q_{0} m_{0} p_{0} }} 
\times \frac{\sum\limits_{i=1}^n{q_{1} m_{1} p_{0} }}{\sum\limits_{i=1}^n{q_{1} m_{0} p_{0} }} 
\times \frac{\sum\limits_{i=1}^n{q_{1} m_{1} p_{1} }}{\sum\limits_{i=1}^n{q_{1} m_{1} p_{0} }} 
\end{align}$$

---

### （案例）多因素变动分析：总变动分析

下面分别进行总变动和因素变动的指数计算和分析。

**步骤2**：对材料支出额总指数变动进行相对数和绝对数分析

$$\begin{align}
K_{qmp}  
= \frac{\sum\limits_{i=1}^n{q_{1} m_{1} p_{1}}}{\sum\limits_{i=1}^n{q_{0} m_{0} p_{0} }} 
= \frac{`r sum_111`}{`r sum_000`}
= `r num_round(sum_111/sum_000)`
= `r num_round(100*sum_111/sum_000, digits = 2)`\%
\end{align}$$

因为产品产量、单耗和价格的变动，使得总支出变动了`r scales::percent(K,accuracy = 0.01)`，实现了总支出变动额
$\Delta = `r sum_111`-`r sum_000`=`r sum_111-sum_000`$

---

### （案例）多因素变动分析：产量变动分析

**步骤3**：产量变动对材料支出额的影响，进行相对数和绝对数分析

$$\begin{align}
K_{q}  
= \frac{\sum\limits_{i=1}^n{q_{1} m_{0} p_{0}}}{\sum\limits_{i=1}^n{q_{0} m_{0} p_{0} }} 
= \frac{`r sum_100`}{`r sum_000`}
= `r num_round(sum_100/sum_000)`
= `r num_round(100*sum_100/sum_000, digits = 2)`\%
\end{align}$$

因为产品产量的变动，使得总支出变动了`r scales::percent(I_q,accuracy = 0.01)`，实现了总支出变动额
$\Delta_q = `r sum_100`-`r sum_000`=`r sum_100-sum_000`$

---

### （案例）多因素变动分析：单耗变动分析

**步骤4**：单耗变动对材料支出额的影响，进行相对数和绝对数分析

$$\begin{align}
K_{m}  
= \frac{\sum\limits_{i=1}^n{q_{1} m_{1} p_{0}}}{\sum\limits_{i=1}^n{q_{1} m_{0} p_{0} }} 
= \frac{`r sum_110`}{`r sum_100`}
= `r num_round(sum_110/sum_100)`
= `r num_round(100*sum_110/sum_100, digits = 2)`\%
\end{align}$$

因为产品单耗的变动，使得总支出变动了`r scales::percent(I_m,accuracy = 0.01)`，实现了总支出变动额
$\Delta_m = `r sum_110`-`r sum_100`=`r sum_110-sum_100`$

---

### （案例）多因素变动分析：价格变动分析

**步骤5**：价格变动对材料支出额的影响，进行相对数和绝对数分析

$$\begin{align}
K_{p}  
= \frac{\sum\limits_{i=1}^n{q_{1} m_{1} p_{1}}}{\sum\limits_{i=1}^n{q_{1} m_{1} p_{0} }} 
= \frac{`r sum_111`}{`r sum_110`}
= `r num_round(sum_111/sum_110)`
= `r num_round(100*sum_111/sum_110, digits = 2)`\%
\end{align}$$

因为产品单耗的变动，使得总支出变动了`r scales::percent(I_p,accuracy = 0.01)`，实现了总支出变动额
$\Delta_p = `r sum_111`-`r sum_110`=`r sum_111-sum_110`$



---

### （案例）多因素变动分析：汇总分析

**相对数**变动分析：

$$\begin{align}
K_{qmp} & = K_q * K_m * K_p \\
`r num_round(100*K, 2)`\%
& = `r num_round(100*I_q, 2)`\%
\times `r num_round(100*I_m, 2)`\%
\times `r num_round(100*I_p, 2)`\%
\end{align}$$

**绝对数**变动分析：

$$\begin{align}
\left( {\sum\limits_{i=1}^n{q_{1} m_{1} p_{1}}}- {\sum\limits_{i=1}^n{q_{0} m_{0} p_{0} }} \right)
&=\left( {\sum\limits_{i=1}^n{q_{1} m_{0} p_{0} }} - {\sum\limits_{i=1}^n{q_{0} m_{0} p_{0} }} \right) \\&+  
\left( {\sum\limits_{i=1}^n{q_{1} m_{1} p_{0} }} - {\sum\limits_{i=1}^n{q_{1} m_{0} p_{0} }}  \right) \\&+ 
\left( {\sum\limits_{i=1}^n{q_{1} m_{1} p_{1} }}- {\sum\limits_{i=1}^n{q_{1} m_{1} p_{0} }} \right) \\
`r num_round(sum_111-sum_000, 2)` & = `r num_round(sum_100-sum_000, 2)` + \left(
`r num_round(sum_110-sum_100, 2)` \right)+ 
`r num_round(sum_111-sum_110, 2)`
\end{align}$$

---

## 平均数指数体系变动分析：平均数

**平均数指数**：是两个平均数直接对比形成的指数。

平均数的大小受两个因素影响：

- 各组水平
$\overline{X_i}$

- 各组结构
$f_i$


$$\begin{align}
\overline{X}=\frac{\sum\limits_{i=1}^n (f_iX_i )}{\sum\limits_{i=1}^n f_i}=\sum\limits_{i=1}^n\left( \frac{f_i}{\sum\limits_{i=1}^n {f_i}} \cdot  X_i\right)
\end{align}$$

---

## 平均数指数体系变动分析：因素分解

总变动的因素分解指数公式：

$$\begin{align}
I_{X f}= I_f \times I_X
\end{align}$$

.pa2.bg-light-yellow[
其中，**总变动指数**：
$$\begin{align}
I_{X f}=\frac{\overline{X}_{1}}{\overline{X}_{0}}=
\left( \frac{\sum\limits_{i=1}^n f_{1i} X_{1i}}{\sum\limits_{i=1i}^n f_{1i}} \right) \Bigg/
\left( \frac{\sum\limits_{i=1}^n f_{0i} X_{0i}}{\sum\limits_{i=1}^n f_{0i}} \right)
\end{align}$$

]

---

## 平均数指数体系变动分析：因素分解

总变动的因素分解指数公式：

$$\begin{align}
I_{X f}= I_f \times I_X
\end{align}$$

.pa2.bg-light-green[
其中，**结构变动指数**：
$$\begin{align}
I_{f}=\frac{\overline{X}_{n}}{\overline{X}_{0}}=
\left( \frac{\sum\limits_{i=1}^n f_{1i} X_{0i}}{\sum\limits_{i=1i}^n f_{1i}} \right) \Bigg/
\left( \frac{\sum\limits_{i=1}^n f_{0i} X_{0i}}{\sum\limits_{i=1}^n f_{0i}} \right)
\end{align}$$

]

---

## 平均数指数体系变动分析：因素分解

总变动的因素分解指数公式：

$$\begin{align}
I_{X f}= I_f \times I_X
\end{align}$$

.pa2.bg-light-blue[

其中，**组水平变动指数**：
$$\begin{align}
I_{X}=\frac{\overline{X}_{1}}{\overline{X}_{n}}=
\left( \frac{\sum\limits_{i=1}^n f_{1i} X_{1i}}{\sum\limits_{i=1i}^n f_{1i}} \right) \Bigg/
\left( \frac{\sum\limits_{i=1}^n f_{1i} X_{0i}}{\sum\limits_{i=1}^n f_{1i}} \right)
\end{align}$$

]

---
exclude: true

## 案例：平均数指数体系

```{r}
source("Rscript/case-index-mean.R", encoding = "UTF-8")
```


---

### （案例）平均数指数变动分析：数据表

**案例说明**：某地区生产同一产品的三个不同企业的职工人数
$f$（百人）和劳动生产率
$X$（万元/人）和资料如下表，请对**人均劳动生产率**进行因素变动分析。 

```{r, warning=FALSE}
names_eng <- c("firm", "f0", "f1", "x_0", "x_1")
names_chn <- c("产品", 
               "人数\\(f_0\\)","人数\\(f_1\\)",
               "生产率\\(X_0\\)","生产率\\(X_1\\)")
calc_index %>%
  select(names_eng) %>%
  #janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  #mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","),
        caption = "案例数据表")
```


---

### （案例）平均数指数变动分析：计算表

**案例解答**：工厂人数和劳动生产率会引发企业整体人均劳动生产率的变动，因此需要使用平均数指数分解，来对**人均劳动生产率**进行因素变动分析。首先得到如下 计算表：

```{r, warning=FALSE}
names_eng <- c("firm", 
               "f0", "f1", 
               "x_0", "x_1",
               "f0x0", "f1x1", "f1x0")
names_chn <- c("产品", 
               "人数\\(f_0\\)","人数\\(f_1\\)",
               "生产率\\(X_0\\)","生产率\\(X_1\\)",
               "\\(f_0X_0\\)","\\(f_1X_1\\)","\\(f_1X_0\\)")
calc_index %>%
  select(names_eng) %>%
  janitor::adorn_totals(.,where = "row",name = c("合计")) %>%
  mutate_at(vars(contains("_")), funs(ifelse(.==max(.), NA, .))) %>%
  rename_at(vars(names(.)),~ all_of(names_chn)) %>%
  kable(escape = T, align = "c",
        format.args = list(big.mark = ","))
```

---

### （案例）平均数指数变动分析：确定计算公式

**步骤1**：根据平均数指数体系变动分析公式，建立如下的因素分析指标体系：

$$\begin{align}
I_{X f} & = I_f \times I_X \\
\frac{\overline{X}_{1}}{\overline{X}_{0}} &= \left(\frac{\overline{X}_{n}}{\overline{X}_{0}}\right) \times
\left(\frac{\overline{X}_{1}}{\overline{X}_{n}}\right)
\end{align}$$

---

### （案例）平均数指数变动分析：总变动分析


**步骤2**：对整个企业人均劳动生产率总指数变动进行相对数和绝对数分析。

其中，**总变动指数**：

$$\begin{align}
I_{X f}=\frac{\overline{X}_{1}}{\overline{X}_{0}}
& =
\left( \frac{\sum\limits_{i=1}^n f_{1i} X_{1i}}{\sum\limits_{i=1i}^n f_{1i}} \right) \Bigg/
\left( \frac{\sum\limits_{i=1}^n f_{0i} X_{0i}}{\sum\limits_{i=1}^n f_{0i}} \right) \\
& = \left( \frac{`r sum_11`}{`r sum_f1`} \right) \Bigg/
\left( \frac{`r sum_00`}{`r sum_f0`} \right) \\
&= `r num_round(x1)`/ `r num_round(x0)`
= `r num_round(K)`
= `r num_round(100*K, 2)`\%
\end{align}$$


因为职工人数、劳动生产率的变动，使得整个企业人均劳动生产率变动了`r scales::percent(K,accuracy = 0.01)`，实现了人均劳动生产率变动绝对数
$\Delta =\overline{X}_1 - \overline{X}_0 = `r num_round(x1)`-`r num_round(x0)`=`r num_round(x1-x0)`$

---

### （案例）平均数指数变动分析：职工人数结构变动分析

**步骤3**：职工人数结构对整个企业人均劳动生产率的影响，进行相对数和绝对数分析

其中，职工人数的**结构变动指数**：
$$\begin{align}
I_{f}=\frac{\overline{X}_{n}}{\overline{X}_{0}}
&=\left( \frac{\sum\limits_{i=1}^n f_{1i} X_{0i}}{\sum\limits_{i=1i}^n f_{1i}} \right) \Bigg/
\left( \frac{\sum\limits_{i=1}^n f_{0i} X_{0i}}{\sum\limits_{i=1}^n f_{0i}} \right) \\
& = \left( \frac{`r sum_10`}{`r sum_f1`} \right) \Bigg/
\left( \frac{`r sum_00`}{`r sum_f0`} \right) \\
& = `r num_round(xn)`/ `r num_round(x0)`
= `r num_round(I_f)`
= `r num_round(100*I_f, 2)`\%
\end{align}$$

因为职工人数结构的变动，使得整个企业**人均劳动生产率**变动了`r scales::percent(I_f,accuracy = 0.01)`，实现了人均劳动生产率变动绝对数
$\Delta =\overline{X}_n - \overline{X}_0 =`r num_round(xn)`-`r num_round(x0)`=`r num_round(xn-x0)`$


---

### （案例）平均数指数变动分析：劳动生产率变动分析

**步骤4**：各厂劳动生产率对整个企业人均劳动生产率的影响，进行相对数和绝对数分析。其中，各厂劳动生产率的**组水平变动指数**：

$$\begin{align}
I_{X}=\frac{\overline{X}_{1}}{\overline{X}_{n}}
&= \left( \frac{\sum\limits_{i=1}^n f_{1i} X_{1i}}{\sum\limits_{i=1i}^n f_{1i}} \right) \Bigg/
\left( \frac{\sum\limits_{i=1}^n f_{1i} X_{0i}}{\sum\limits_{i=1}^n f_{1i}} \right) \\
& = \left( \frac{`r sum_11`}{`r sum_f1`} \right) \Bigg/
\left( \frac{`r sum_10`}{`r sum_f1`} \right) \\
& = `r num_round(x1)`/ `r num_round(xn)`
= `r num_round(I_x)`
= `r num_round(100*I_x, 2)`\%
\end{align}$$

因为各厂劳动生产率水平的变动，使得整个企业**人均劳动生产率**变动了`r scales::percent(I_x,accuracy = 0.01)`，实现了人均劳动生产率变动绝对数
$\Delta =\overline{X}_1 - \overline{X}_n =`r num_round(x1)`-`r num_round(xn)`=`r num_round(x1-xn)`$



---

### （案例）平均数指数变动分析：汇总分析

**相对数**变动分析：

$$\begin{align}
I_{X f} &= I_f \times I_X \\
\frac{\overline{X}_{1}}{\overline{X}_{0}} &= \left(\frac{\overline{X}_{n}}{\overline{X}_{0}}\right) \times
\left(\frac{\overline{X}_{1}}{\overline{X}_{n}}\right) \\
`r num_round(100*K, 2)`\%
& = `r num_round(100*I_f, 2)`\%
\times `r num_round(100*I_x, 2)`\%
\end{align}$$

**绝对数**变动分析：

$$\begin{align}
\left(\overline{X}_1 - \overline{X}_0 \right) & = 
\left(\overline{X}_n - \overline{X}_0 \right)  + \left(\overline{X}_1 - \overline{X}_n \right) \\
\left(`r num_round(x1)`- `r num_round(x0)` \right) & = 
\left(`r num_round(xn)`- `r num_round(x0)` \right)  + \left(`r num_round(x1)`- `r num_round(xn)` \right) \\
\left(`r num_round(x1 - x0)` \right) 
& = \left(`r num_round(xn -  x0)` \right)  + \left(`r num_round(x1 - xn)` \right) 
\end{align}$$

---
layout: false
class: center, middle, duke-softblue,hide_logo
name: index-life

# 7.4 几种典型的指数

### 零售价格指数

### 消费价格指数

### 居民消费价格指数

### 股票价格指数

---
layout: true

<div class="my-header-h2"></div>

<div class="watermark1"></div>

<div class="watermark2"></div>

<div class="watermark3"></div>

<div class="my-footer"><span>huhuaping@  &emsp;&emsp; <a href="#chapter"> 第07章 指数 </a>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
<a href="#index-life"> 7.4 几种典型的指数 </a> </span></div>

---

## 零售价格指数：概念和作用

**零售价格指数**(retailer price index)：是指以现金或信用卡形式支付的零售商品的价格指数。

零售价格指数的意义：

> 
- 该指数持续上升，可能带来通货膨胀上升的压力，令政府收紧货币供应，利率趋升为该国货币带来利好的支持。

中国的零售价格指数：

- 反映城乡商品零售价格变动趋势的一种经济指数 

- 它的变动直接影响到城乡居民的生活支出和国家财政收入

- 是观察和分析经济活动的重要工具之一 

---

## 零售价格指数：编制过程

我国零售价格指数编制过程

A.调查地区和调查点的选择（采用分层抽样）：

> 
- 调查地区按经济区域和地区分布合理等原则
- 选出具有代表性的大、中、小城市和县
- 选择经营规模大、商品种类多的上场(包括集市) 作为调查点 

B.编制公式（固定权数的平均数指数）：

$$\begin{align}
\overline{K}_p = \frac{\sum\limits_{i = 1}^n (k_{pi} \cdot w_i)}{\sum\limits_{i = 1}^n k_{pi}}
\end{align}$$

> 其中：
$k_{pi}$为个体价格指数或价格类指数；
$w_{i}$为各层次零售额比重。

---

## 消费价格指数：概念和特点

**消费者价格指数**(consumer price index)：是对一个固定的消费品篮子价格的衡量，主要反映消费者支付商品和劳务的价格变化情况。它是一种度量通货膨胀水平的工具，以百分比变化为表达形式，一般简写为CPI。 

消费者价格指数的特点：

> 
- 世界各国普遍编制的一种指数
- 我国称之为居民消费价格指数
- 可就城乡分别编制

---

## 消费价格指数：作用

消费价格指数的作用主要体现在：

- 反映货币购买力变动

$$货币购买力指数 = \frac{1}{cpi}\times 100\%$$

- 反映对职工实际工资的影响

$$实际工资 = \frac{名义工资}{cpi}$$

- 用于缩减经济序列<sup>* </sup>（剔除货币波动效应）



---
layout: false
background-size: contain
background-image: url("../pic/chpt07-cpi-demo.png")
class: center, middle, duke-orange, hide_logo

.fl.bold.w-20[
CPI编制过程与零售价格指数类似，它包括一揽子特定商品。]


---
layout: true

<div class="my-header-h2"></div>

<div class="watermark1"></div>

<div class="watermark2"></div>

<div class="watermark3"></div>

<div class="my-footer"><span>huhuaping@  &emsp;&emsp; <a href="#chapter"> 第07章 指数 </a>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
<a href="#report"> 7.4 几种典型的指数 </a> </span></div>

---
exclude:true

## （案例）地区消费价格指数及平减

```{r}
food <- tibble::tribble(~"食品类别",
                ~"9月价格(元)", ~"10月价格(元)",
                ~"权数W(%)", ~"指数i(%)",
                "1 粮食",     NA,   NA,   35, "d）___", 
                "1.1 细粮",   NA,   NA,   65, "c）___" ,
                "1.1.1 面粉", 2.84, 3.16, 40, "a）___", 
                "1.1.2 大米", 4.50, 4.82, 60, "b）___", 
                "1.2 粗粮",   NA,   NA,   35, "107.6",
                "2 副食品",   NA,   NA,   45, "116.2", 
                "3 其他食品", NA,   NA,   20, "112.5")
i_a <- 100*3.16/2.84
i_b <- 100*4.82/4.5
i_c <- 0.4*i_a +0.6*i_b
i_d <- 0.35*107.6 + 0.65*i_c
i_food <- 0.35 * i_d + 0.45*116.2 + 0.2*112.5

```


```{r cpi-wage}
cpi_wage <- as_tibble(openxlsx::read.xlsx("../data/cpi-deflation.xlsx",detectDates=T))

```

---

### （案例）消费者价格指数的计算：数据表

**案例说明**：某地区发布了2018年9月和10月的**食品类**消费价格指数统计资料：

```{r food-price}
food %>%
  mutate_all(as.character) %>%
  kable(caption = "2018年9月和10月食品价格统计资料")
```

请根据上述**食品类**价格统计资料，（1）计算表中所空缺的a）、b）、c）、d）数值。（2）利用计算结果，进一步计算该地区**食品**消费价格指数。

---

### （案例）消费者价格指数的计算：分析解答1

**案例解答**：


（1）个体指数计算公式为：
$k_{p_i} = \frac{P_{1,i}}{P_{0,i}}$； 固定权重的加权指数计算公式为：

$i=\frac{\sum{k_{p_i} \cdot w_i}}{\sum{w_i}}$。所以可以计算得出：

a）
$i_a=k_{p_a}=100*\frac{3.16}{2.84}=$ 
`r formatC(i_a, digits=1, format="f")`

b）
$i_b=k_{p_b}=100*\frac{4.82}{4.5}=$ `r formatC(i_b, digits=1, format="f")`

c）
$i_c=\frac{\sum{k_{p_i} \cdot w_i}}{\sum{w_i}}=\frac{i_a * 40\% +i_b * 60\% }{40\% + 60\% }=$ `r formatC(i_c, digits=1, format="f")`

d）
$i_d=\frac{\sum{k_{p_i} \cdot w_i}}{\sum{w_i}}=\frac{i_c * 65\% +107.6 * 35\% }{65\% + 35\%}=$ `r formatC(i_d, digits=1, format="f")`

---

### （案例）消费者价格指数的计算：分析解答2

**案例解答**：

（2）固定权重的加权指数计算公式为：

$$i=\frac{\sum{k_{p_i} \cdot w_i}}{\sum{w_i}}$$

所以可以计算得出：

$$i_{food}=\frac{\sum{k_{p_i} \cdot w_i}}{\sum{w_i}}=\frac{i_d * 35\% +116.2 * 45\% +112.5 * 20\% }{35\% + 45\% + 20\% }= `r formatC(i_food, digits=1, format="f")`$$

---

### （案例）消费者价格指数平减：工人工资

.pull-left[
**案例说明**：某地区某国有企业的人均工资（元/人）情况如右表所示。

- 为了计算工人实际工资，并且使得各月份的实际工资具有可比较性。请根据上资料，以2018年6月为不变价格进行CPI平减（即以6月CPI为基准水平进行计算），计算1-10月期间工人每月的**实际**人均工资。

]

.pull-right[
```{r}
cpi_wage %>%
  select(1:3) %>%
  mutate_all(as.character) %>%
  kable(align =  "c")
```
]


---

### （案例）消费者价格指数平减：分析解答

**分析思路**：

第1步：把当期CPI序列（记为
$CPI_t, \ \ t \in 1, 2, ..., 10$）转换成以2018年6月为基准的CPI序列（记为
$CPI_{6,t},  \ \ t \in 1, 2, ..., 10$），计算公式为

$$CPI_{6,t}= 100*\frac{CPI_t}{CPI_6}$$

第2步：把当期工资（名义工资）序列（记为
$Wage_t,  \ \ t \in 1, 2, ..., 10$）换算成以2018年6月CPI为基准的**“实际工资”**序列（记为
$Wage_{6,t},  \ \ t \in 1, 2, ..., 10$）。计算公式为

$$Wage_{6,t}=\frac{Wage_t}{CPI_{6,t}}$$

---

### （案例）消费者价格指数平减：分析解答

**计算过程**：计算过程和结果见下表

```{r}
cpi_wage %>% 
  select(1:3) %>%
  mutate(`CPI新序列(%,按6月计)`= round(100*`CPI（%,当期值）`/101.9, digits=1),
         `工资新序列(元/人,按6月计)`= round(100*`工资（元/人,当期值）` / `CPI新序列(%,按6月计)`, digits=1)) %>%
  mutate_all(as.character) %>%
  kable(align = "c")
 
```


---

## 生产价格指数：概念和特点


**生产者价格指数**(Producer Price Index)：衡量制造商和农场主向商店出售商品的价格指数，一般简写为PPI。。

> 它主要反映生产资料的价格变化状况，用于衡量各种商品在不同生产阶段的成本价格变化情况。 

生产者价格指数的特点：

- 测量在初级市场上出售的货物的价格变动的一种价格指数

- 根据每种商品在非零售市场上首次交易时的价格计算的

- 生产价格指数的上涨反映了生产者价格的提高，也将反映消费价格和生活费用未来的趋势

- 通常是按月公布

---

## 股票价格指数：概念和特点

**股票价格指数**(stock price index)：反映某一股票市场上多种股票价格变动趋势的一种相对数，简称股价指数。

股票价格指数的特点：

- 其单位一般用“点”(point)表示，即将基期指数作为100，每上升或下降一个单位称为“1点”

- 计算时一般以发行量为权数进行加权综合。其公式为 

$$\begin{align}
I_{p}=\frac{\sum\limits_{i=1}^n (p_{1 i} q_{i})}{\sum\limits_{i=1}^n (p_{0 i} q_{i})}
\end{align}$$

---

## 股票价格指数：主要证券交易指数


世界主要证券交易所的股票价格指数

- 美国的道·琼斯指数和标准普尔指数；

- 伦敦金融时报FTSE指数；

- 法兰克福DAX指数；巴黎CAC指数；

- 瑞士的苏黎士SMI指数；

- 日本的日京指数；

- 香港的恒生指数

我国大陆的两个证券交易所

- 上交所的综合指数和180指数

- 深交所的成分股指数和综合指数


---
layout:false
background-image: url("../pic/thank-you-gif-funny-little-yellow.gif")
class: inverse,center
# 本节结束

