<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>05-01-relationship.utf8</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/duke-blue.css" rel="stylesheet" />
    <link href="libs/remark-css/hygge-duke.css" rel="stylesheet" />
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/tabwid/tabwid.css" rel="stylesheet" />
    <link rel="stylesheet" href="../mycss/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="../mycss/my-font.css" type="text/css" />
    <link rel="stylesheet" href="../mycss/my-custom-for-video-roomy.css" type="text/css" />
    <link rel="stylesheet" href="../mycss/text-box.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

background-image: url("../pic/slide-front-page.jpg")
class: center,middle
exclude: FALSE

# 统计学原理(Statistic)

&lt;!---    chakra: libs/remark-latest.min.js ---&gt;

### 胡华平

### 西北农林科技大学

### 经济管理学院数量经济教研室

### huhuaping01@hotmail.com

### 2021-05-18




<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 70px;
z-index: 0;
background-image: url(../pic/logo/nwafu-logo-circle-wb.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:0.2em;left:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>

---
class: center, middle, duke-orange,hide_logo
name:chapter
exclude: FALSE

# 第五章 相关和回归分析


### [.white[5.1 变量间关系的度量]](#corl)

### [5.2 回归分析的基本思想](#concept)

### [5.3 OLS方法与参数估计](#ols)

### [5.4 假设检验](#hypthesis)

### [5.5 拟合优度与残差分析](#goodness)

### [5.6 回归预测分析](#forecast)

### [5.7 回归报告解读](#report)

---
layout: false
class: center, middle, duke-softblue,hide_logo
name: corl

# 5.1 变量间关系的度量

### [变量间的关系](#corl-vars)

### [相关关系的描述与测度](#corl-measure)

### [相关系数的显著性检验](#corl-test)

---
layout: true

&lt;div class="my-header-h2"&gt;&lt;/div&gt;

&lt;div class="watermark1"&gt;&lt;/div&gt;

&lt;div class="watermark2"&gt;&lt;/div&gt;

&lt;div class="watermark3"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@  &amp;emsp;&amp;emsp; &lt;a href="#chapter"&gt; 第05章 相关和回归分析 &lt;/a&gt;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="#corl"&gt; 5.1 变量间关系的度量 &lt;/a&gt; &lt;/span&gt;&lt;/div&gt; 

---

### （示例）变量间的关系：经济学专业解读

&lt;img src="../pic/chpt05-intro-1-econ.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “我们数据不少，做了很严格的回归，但异常值略多略多，符合理论的数值反而难找……”

---

### （示例）变量间的关系：金融学专业解读

&lt;img src="../pic/chpt05-intro-2-fin.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “我们的数据多如牛毛，无孔不入。即使做完回归，也会发现异常值和符合理论的数值多得不忍直视。”

---

### （示例）变量间的关系：土木工程专业解读

&lt;img src="../pic/chpt05-intro-3-engine.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “我们得要设计余量，所以理论设计得远高于实际承受……”

---

### （示例）变量间的关系：物理学专业解读

&lt;img src="../pic/chpt05-intro-4-physics.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “我们的理论和数据严丝合缝，bingo！”

---

### （示例）变量间的关系：环境科学专业解读

&lt;img src="../pic/chpt05-intro-5-eniron.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “我们的理论和数据大致吻合，就是……应用范围有点蛋疼。”

---

### （示例）变量间的关系：历史学专业解读

&lt;img src="../pic/chpt05-intro-6-history.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “数据虽然很多，可我们能用理论把他们统统连起来！”

---

### （示例）变量间的关系：政治学专业解读

&lt;img src="../pic/chpt05-intro-7-politics.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “世界大势一日三变，尽管我们数据不少，可……我们的理论跟数据趋势是反着来的……”

---

### （示例）变量间的关系：社会学专业解读

&lt;img src="../pic/chpt05-intro-8-sociology.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “学海无涯苦作舟。那么多数据，那么多理论，慢慢学，恩……”

---

### （示例）变量间的关系：数学专业解读

&lt;img src="../pic/chpt05-intro-9-math.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “数据很少，但能建立理论～”

---

### （示例）变量间的关系：新闻学专业解读

&lt;img src="../pic/chpt05-intro-10-journalism.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; （示例）“只有一个数据，也能建立理论……”

---

### （示例）变量间的关系：哲学专业解读

&lt;img src="../pic/chpt05-intro-11-philosophy.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “没有数据，依然建立理论……”


---

### （示例）变量间的关系：文学批评专业解读

&lt;img src="../pic/chpt05-intro-12-literary.png" width="60%" style="display: block; margin: auto;" /&gt;

&gt; “如图所示，你懂的……”

---
name: corl-vars

## 变量间的关系：函数关系

两个变量若存在是一一对应的确定关系，则称之为二者具有**函数关系**。

&lt;div class="notes"&gt;
&lt;p&gt;设有两个变量 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;和 &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;，变量 &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;随变量 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;一起变化，并完全依赖于 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;，当变量 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;取某个数值时， &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;依确定的关系取相应的值，则称 &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;是 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;的函数，记为 &lt;span class="math inline"&gt;\(Y = f(X)\)&lt;/span&gt;，其中 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;称为自变量， &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;称为因变量。&lt;/p&gt;
&lt;/div&gt;



&gt; 从**几何学**角度来看，数据集各观测点会落在一条曲线上。

---

### （示例）函数关系

某种商品的销售额
`\(Y\)`与销售量
`\(X\)`之间的关系可表示为(
`\(P\)`为单价)：

`$$Y_i = P_i\cdot X_i$$`

圆的面积
`\(S\)`与半径
`\(R\)`之间的关系可表示为：

`$$S = \pi R^2$$`

企业的原材料消耗额
`\(Y\)`与产量
`\(X1\)` 、单位产量消耗
`\(X2\)` 、原材料价格
`\(X3\)`之间的关系可表示为：

`$$Y = X_1 \cdot X_2 \cdot X_3$$`

---

## 变量间的关系：相关关系(correlation)

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="../pic/chpt05-measure-rel.png" alt="相关关系的类型" width="90%" /&gt;
&lt;p class="caption"&gt;相关关系的类型&lt;/p&gt;
&lt;/div&gt;


---

### （示例）相关关系

&lt;div class="case"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;父亲身高 &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;与子女身高 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;之间的关系&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;收入水平 &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;与受教育程度 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;之间的关系&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;粮食单位面积产量 &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;与施肥量 &lt;span class="math inline"&gt;\(X1\)&lt;/span&gt; 、降雨量 &lt;span class="math inline"&gt;\(X2\)&lt;/span&gt;、温度 &lt;span class="math inline"&gt;\(X3\)&lt;/span&gt;之间的关系&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;商品的消费量 &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;与居民收入 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;之间的关系&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;商品销售额 &lt;span class="math inline"&gt;\(Y\)&lt;/span&gt;与广告费支出 &lt;span class="math inline"&gt;\(X\)&lt;/span&gt;之间的关系&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;


---

## 相关关系的描述与测度：问题与假定

相关分析要解决的问题：

- 变量之间是否存在关系？

- 如果存在关系，它们之间是什么样的关系？

- 变量之间的关系强度如何？

- 样本所反映的变量之间的关系能否代表总体变量之间的关系？

相关分析中的总体假定：

- 两个变量之间是线性关系

- 两个变量都是随机变量

---

## 相关关系的描述与测度：散点图

.fl.w-50[

&lt;img src="../pic/chpt05-scatter-p0.png" width="583" style="display: block; margin: auto;" /&gt;
]

--

.fl.w-50[

&lt;img src="../pic/chpt05-scatter-p1.png" width="583" style="display: block; margin: auto;" /&gt;
]

---

## 相关关系的描述与测度：散点图


.fl.w-50[

&lt;img src="../pic/chpt05-scatter-n0.png" width="583" style="display: block; margin: auto;" /&gt;

]

--

.fl.w-50[

&lt;img src="../pic/chpt05-scatter-n1.png" width="583" style="display: block; margin: auto;" /&gt;

]

---

## 相关关系的描述与测度：散点图

.fl.w-50[

&lt;img src="../pic/chpt05-scatter-nonline.png" width="584" style="display: block; margin: auto;" /&gt;

]

--

.fl.w-50[

&lt;img src="../pic/chpt05-scatter-independence.png" width="584" style="display: block; margin: auto;" /&gt;

]

---

## 相关关系的描述与测度：散点图

&lt;img src="../pic/chpt05-scatter-all-cases.png" width="90%" style="display: block; margin: auto;" /&gt;

---

### （示例）两类油价的散点图

&lt;img src="../pic/chpt05-scatter-oil-price.png" width="90%" style="display: block; margin: auto;" /&gt;

---

### （示例）传染病与认知水平的散点图

&lt;img src="../pic/chpt05-scatter-disease.png" width="80%" style="display: block; margin: auto;" /&gt;

---
name: corl-measure

## 相关关系的描述与测度：相关系数

**相关系数**(correlation coefficient)：是度量变量之间关系强度的一个统计量。

- 它是对两个变量之间线性相关强度的一种度量。

- 一般称为**简单相关系数**，也称为**线性相关系数**(linear correlation coefficient) 。

- 或称为**Pearson相关系数**(Pearson’s correlation coefficient) 。

相关系数记号表达：

- 若相关系数是根据总体全部数据计算的，称为总体相关系数，记为
`\(\rho\)`。

- 若是根据样本数据计算的，则称为样本相关系数，简称为相关系数，记为
`\(r\)`。


---

## 相关关系的描述与测度：计算公式

.mb1.pa1.bg-light-blue[
简单相关系数的大FF计算公式：

`$$\begin{align}
r &amp; = \frac{n \sum X_i Y_i -\sum X_i \sum Y_i}{\sqrt{n \sum X_i^{2}-\left(\sum X_i\right)^{2}} \cdot \sqrt{n \sum Y_i^{2}-\left(\sum Y_i\right)^{2}}} \tag{eq01}
\end{align}$$`

]

.mb1.pa1.bg-light-blue[
简单相关系数的小ff计算公式：

`$$\begin{align}
r &amp; = \frac{ \sum{\left( (X_i - \overline{X})(Y_i - \overline{Y})\right ) } }{\sqrt{\sum{(X_i - \overline{X})^2 }\sum{(Y_i - \overline{Y})^2}}} 
= \frac{S S_{XY}}{\sqrt{S S_{XX}} \sqrt{S S_{YY}}}
= \frac{\sum{x_iy_i}}{\sqrt{\sum{x_i^2}\sum{y_i^2}}}
\tag{eq02}
\end{align}$$`

]


.mb1.pa1.bg-lightest-blue[

`$$\begin{align}
S S_{X X} =\sum_{i=1}^{n}\left(X_{i}-\overline{X}\right)^{2}  ;\quad 
S S_{Y Y} =\sum_{i=1}^{n}\left(Y_{i}-\overline{Y}\right)^{2}  ;\quad 
S S_{X Y}=\sum_{i=1}^{n}\left(X_{i}-\overline{X}\right)\left(Y_{i}-\overline{Y}\right)
\end{align}$$`

]


---

## 相关关系的描述与测度：特征

简单相关系数的特征：

**性质1**：
`\(r\)`的取值范围是
`\([-1,1]\)`，
`\(|r|\)`越趋于1表示相关关系越强；
`\(|r|\)`越趋于0表示相关关系越弱。


- 如果
`\(|r|=1\)`，为完全相关。其中
`\(r =1\)`，为完全正相关；
`\(r =-1\)`，为完全负正相关

- 如果
`\(r = 0\)`，不存在线性相关关系

- 如果
`\(-1&lt;r&lt;0\)`，为负相关；如果
`\(0&lt;r&lt;1\)`，为正相关。


**性质2**：r具有对称性。即
`\(X\)`与
`\(Y\)`之间的相关系数和
`\(Y\)`与
`\(X\)`之间的相关系数相等，即
`\(r_{XY}= r_{YX}\)`。

---

## 相关关系的描述与测度：特征

简单相关系数的特征：

**性质3**：
`\(r\)`数值大小与
`\(X\)`和
`\(Y\)`原点及尺度无关，即改变
`\(X\)`和
`\(Y\)`的数据原点及计量尺度，并不改变
`\(r\)`数值大小。

**性质4**：仅仅是
`\(X\)`与
`\(Y\)`之间线性关系的一个度量，它不能用于描述非线性关系。这意为着，
`\(r=0\)`只表示两个变量之间不存在线性相关关系，并不说明变量之间没有任何关系

**性质5**：
`\(r\)`虽然是两个变量之间线性关系的一个度量，却不一定意味着
`\(X\)`与
`\(Y\)`一定有因果关系。

---

## 相关关系的描述与测度：解释


&lt;div class="fyi"&gt;
&lt;p&gt;下面给出实证研究时，对相关系数的经验解释：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;当 &lt;span class="math inline"&gt;\(|r|&amp;lt;0.8\)&lt;/span&gt;时，可视为两个变量之间高度相关。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当 &lt;span class="math inline"&gt;\(0.5&amp;lt;|r|&amp;lt;0.8\)&lt;/span&gt;时，可视为中度相关。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当 &lt;span class="math inline"&gt;\(0.3&amp;lt;|r|&amp;lt;0.5\)&lt;/span&gt;时，视为低度相关。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当 &lt;span class="math inline"&gt;\(|r|&amp;lt;0.3\)&lt;/span&gt;时，说明两个变量之间的相关程度极弱，可视为不相关。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;而且上述解释必须建立在对相关系数的显著性进行检验的基础之上。&lt;/p&gt;
&lt;/div&gt;

---

## 相关关系的描述与测度：简单相关系数


**简单相关系数**（simple correlation coefficient）：

.pull-left[

- 
`\(Y_i\)`和
`\(X_{2i}\)`之间的相关系数：

`$$\begin {align}
r_{12}=\frac{\sum y_{i} x_{2 i}}{\sqrt{\sum y_{i}^{2}} \sqrt{\sum x_{2 i}^{2}}}
\end {align}$$`

- 
`\(Y_i\)`和
`\(X_{3i}\)`之间的相关系数：

`$$\begin {align} 
r_{13}=\frac{\sum y_{i} x_{3 i}}{\sqrt{\sum y_{i}^{2}} \sqrt{\sum x_{3 i}^{2}}}
\end {align}$$`

]

.pull-right[

- 
`\(X_{2i}\)`和
`\(X_{3i}\)`之间的相关系数：

`$$\begin {align} 
r_{23}=\frac{\sum x_{2 i} x_{3 i}}{\sqrt{\sum x_{2 i}^{2}} \sqrt{\sum x_{3 i}^{2}}}
\end {align}$$`

]

---

## 相关关系的描述与测度：偏相关系数


**偏相关系数**（partial correlation coefficient）：
一个不依赖于
`\(X_{2i}\)`的，对
`\(X_{3i}\)`和
`\(Y_i\)`的影响的一种相关系数。

.pull-left[

- 保持
`\(X_{3i}\)`不变，
`\(Y_i\)`和
`\(X_{2i}\)`之间的相关系数：

`$$\begin {align} 
r_{12 \cdot 3}=\frac{r_{12}-r_{13} r_{23}}{\sqrt{\left(1-r_{13}^{2}\right)\left(1-r_{23}^{2}\right)}}
\end {align}$$`

- 保持
`\(X_{2i}\)`不变，
`\(Y_i\)`和
`\(X_{3i}\)`之间的相关系数：

`$$\begin {align} 
r_{13.2}=\frac{r_{13}-r_{12} r_{23}}{\sqrt{\left(1-r_{12}^{2}\right)\left(1-r_{23}^{2}\right)}}
\end {align}$$`

]

.pull-right[

- 保持
`\(Y_i\)`不变，
`\(X_{2i}\)`和
`\(X_{3i}\)`之间的相关系数：

`$$\begin {align} 
r_{23.1}=\frac{r_{23}-r_{12} r_{13}}{\sqrt{\left(1-r_{12}^{2}\right)\left(1-r_{13}^{2}\right)}}
\end {align}$$`

]

---
name: corl-test

## 相关系数的显著性检验

**相关系数的显著性检验**，是指检验两个变量之间是否存在线性相关关系。

相关系数的显著性检验方法包括：

- 等价于对回归斜率系数
`\(\beta_1\)`的检验（仅针对一元回归）

- 采用R. A. Fisher提出的t检验

---

## 相关系数的显著性检验

相关系数的显著性检验步骤：

1）提出假设：
`\(H_0: \rho =0; H_1: \rho \neq 0\)`

2）计算样本统计量

`$$T^{\ast} = |r|\sqrt{\frac{n-2}{1-r^2}} \quad \sim t(n-2)$$`

3）给定显著性水平
`\(\alpha\)`，确定t理论分布值
`\(t_{1-\alpha/2}(n-2)\)`。

4）得到假设检验结论：

- 若
`\(T^{\ast}&gt; t_{1-\alpha/2}(n-2)\)`，则拒绝
`\(H_0\)`，认为显著存在相关关系；

- 若
`\(T^{\ast} &lt; t_{1-\alpha/2}(n-2)\)`，则无法拒绝
`\(H_0\)`，认为相关关系不显著。

---

exclude: true

## （案例）银行贷款




---

### （案例）银行贷款：案例数据

**案例说明**：某银行共有25家分行，分行及所在地区的相关变量数据如下表所示。

<div id="htmlwidget-cedc2a058326500b2d1f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cedc2a058326500b2d1f">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],[0.9,1.1,4.8,3.2,7.8,2.7,1.6,12.5,1,2.6,0.3,4,0.8,3.5,10.2,3,0.2,0.4,1,6.8,11.6,1.6,1.2,7.2,3.2],[67.3,111.3,173,80.8,199.7,16.2,107.4,185.4,96.1,72.8,64.2,132.2,58.6,174.6,263.5,79.3,14.8,73.5,24.7,139.4,368.2,95.7,109.6,196.2,102.2],[6.8,19.8,7.7,7.2,16.5,2.2,10.7,27.1,1.7,9.1,2.1,11.2,6,12.7,15.6,8.9,0.6,5.9,5,7.2,16.8,3.8,10.3,15.8,12],[5,16,17,10,19,1,17,18,10,14,11,23,14,26,34,15,2,11,4,28,32,10,14,16,10],[51.9,90.9,73.7,14.5,63.2,2.2,20.2,43.8,55.9,64.3,42.7,76.7,22.8,117.1,146.7,29.9,42.1,25.3,13.4,64.3,163.9,44.5,67.9,39.7,97.1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ID.bank<\/th>\n      <th>loan.bad<\/th>\n      <th>loan.surplus<\/th>\n      <th>loan.receivable<\/th>\n      <th>loan.numbers<\/th>\n      <th>investment.fixed<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":7,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[7,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

.footnote[**说明**：上述变量的含义分别是ID.bank（分行编号）、loan.bad（不良贷款）、loan.surplus（各项贷款余额
）、loan.receivable（本年累计应收贷款）、loan.numbers（贷款项目个数）、investment.fixed（本年固定资产投资额）。]

---

### （案例）银行贷款：不良贷款VS贷款余额的散点图

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="05-01-relationship_files/figure-html/unnamed-chunk-30-1.png" alt="不良贷款VS贷款余额散点图"  /&gt;
&lt;p class="caption"&gt;不良贷款VS贷款余额散点图&lt;/p&gt;
&lt;/div&gt;



---

### （案例）银行贷款：不良贷款VS贷款余额的相关系数（大FF）


<div id="htmlwidget-82912c756d39aef873cb" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-82912c756d39aef873cb">{"x":{"filter":"none","caption":"<caption>大FF计算表<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26"],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","Total"],[0.9,1.1,4.8,3.2,7.8,2.7,1.6,12.5,1,2.6,0.3,4,0.8,3.5,10.2,3,0.2,0.4,1,6.8,11.6,1.6,1.2,7.2,3.2,93.2],[67.3,111.3,173,80.8,199.7,16.2,107.4,185.4,96.1,72.8,64.2,132.2,58.6,174.6,263.5,79.3,14.8,73.5,24.7,139.4,368.2,95.7,109.6,196.2,102.2,3006.7],[60.57,122.43,830.4,258.56,1557.66,43.74,171.84,2317.5,96.1,189.28,19.26,528.8,46.88,611.1,2687.7,237.9,2.96,29.4,24.7,947.92,4271.12,153.12,131.52,1412.64,327.04,17080.14],[4529.29,12387.69,29929,6528.64,39880.09,262.44,11534.76,34373.16,9235.21,5299.84,4121.64,17476.84,3433.96,30485.16,69432.25,6288.49,219.04,5402.25,610.09,19432.36,135571.24,9158.49,12012.16,38494.44,10444.84,516543.37],[0.81,1.21,23.04,10.24,60.84,7.29,2.56,156.25,1,6.76,0.09,16,0.64,12.25,104.04,9,0.04,0.16,1,46.24,134.56,2.56,1.44,51.84,10.24,660.1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ID.bank<\/th>\n      <th>Y<\/th>\n      <th>X<\/th>\n      <th>XY<\/th>\n      <th>X_sqr<\/th>\n      <th>Y_sqr<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":7,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[7,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render"],"jsHooks":[]}</script>



---

### （案例）银行贷款：不良贷款VS贷款余额的相关系数（大FF）

相关系数
`\(r\)`的大FF计算公式（`eq01`）：


`$$\begin{align}
r &amp; = \frac{n \sum X_i Y_i -\sum X_i \sum Y_i}{\sqrt{n \sum X_i^{2}-\left(\sum X_i\right)^{2}} \cdot \sqrt{n \sum Y_i^{2}-\left(\sum Y_i\right)^{2}}} \\
&amp; = \frac{25 \times 17080.14 - 3006.7 \times 93.2}{\sqrt{25 \times 516543.37-\left(3006.7\right)^2} \cdot \sqrt{25 \times 660.1-\left( 93.2\right)^{2}}}  \\
&amp; = 0.8436
\end{align}$$`



---

### （案例）银行贷款：不良贷款VS贷款余额的相关系数（小ff）


<div id="htmlwidget-fd4eafa7bcb2eefe1fa5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fd4eafa7bcb2eefe1fa5">{"x":{"filter":"none","caption":"<caption>小ff计算表<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26"],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","Total"],[0.9,1.1,4.8,3.2,7.8,2.7,1.6,12.5,1,2.6,0.3,4,0.8,3.5,10.2,3,0.2,0.4,1,6.8,11.6,1.6,1.2,7.2,3.2,93.2],[67.3,111.3,173,80.8,199.7,16.2,107.4,185.4,96.1,72.8,64.2,132.2,58.6,174.6,263.5,79.3,14.8,73.5,24.7,139.4,368.2,95.7,109.6,196.2,102.2,3006.7],[-52.968,-8.968,52.732,-39.468,79.432,-104.068,-12.868,65.132,-24.168,-47.468,-56.068,11.932,-61.668,54.332,143.232,-40.968,-105.468,-46.768,-95.568,19.132,247.932,-24.568,-10.668,75.932,-18.068,-6.3948846218409e-14],[-2.828,-2.628,1.072,-0.528,4.072,-1.028,-2.128,8.772,-2.728,-1.128,-3.428,0.272,-2.928,-0.228,6.472,-0.728,-3.528,-3.328,-2.728,3.072,7.872,-2.128,-2.528,3.472,-0.528,5.32907051820075e-15],[2805.609024,80.4250240000001,2780.663824,1557.723024,6309.442624,10830.148624,165.585424,4242.177424,584.092224,2253.211024,3143.620624,142.372624,3802.942224,2951.966224,20515.405824,1678.377024,11123.499024,2187.245824,9133.242624,366.033424,61470.276624,603.586624,113.806224,5765.668624,326.452624,154933.5744],[7.997584,6.906384,1.149184,0.278784,16.581184,1.056784,4.528384,76.947984,7.441984,1.272384,11.751184,0.0739840000000001,8.573184,0.0519839999999999,41.886784,0.529984,12.446784,11.075584,7.441984,9.437184,61.968384,4.528384,6.390784,12.054784,0.278784,312.6504],[149.793504,23.567904,56.528704,20.839104,323.447104,106.981904,27.383104,571.337904,65.930304,53.543904,192.201104,3.245504,180.563904,-12.387696,926.997504,29.824704,372.091104,155.643904,260.709504,58.773504,1951.720704,52.280704,26.968704,263.635904,9.53990399999999,5871.1624]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ID.bank<\/th>\n      <th>Y<\/th>\n      <th>X<\/th>\n      <th>x<\/th>\n      <th>y<\/th>\n      <th>x_sqr<\/th>\n      <th>y_sqr<\/th>\n      <th>xy<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\");\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":7,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[7,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script>



---

### （案例）银行贷款：不良贷款VS贷款余额的相关系数

相关系数
`\(r\)`的小FF计算公式（`eq02`）：

`$$\begin{align}
r &amp; = \frac{ \sum{\left( (X_i - \overline{X})(Y_i - \overline{Y})\right ) } }{\sqrt{\sum{(X_i - \overline{X})^2 (Y_i - \overline{Y})^2}}} \\
&amp; = \frac{\sum{x_i y_i}}{\sqrt{\sum{x_i^2}\sum{y_i^2}}} \\
&amp; = \frac{5871.16}{\sqrt{ 154933.57 \times 312.65}} \\
&amp; = 0.8436
\end{align}$$`



---

### （案例）银行贷款：相关系数矩阵表(Pearson)


```r
corl_pearson&lt;- round(cor(df_loan[,-1], method = "pearson"),4) 
corl_pearson[upper.tri(corl_pearson)]&lt;- NA
```



&lt;template id="c78e5334-95bc-4744-8d2d-8f7a602869c5"&gt;&lt;style&gt;
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
&lt;/style&gt;&lt;div class="tabwid"&gt;&lt;style&gt;.cl-449b2eac{border-collapse:collapse;}.cl-4486e992{font-family:'Arial';font-size:19pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4486e993{font-family:'Arial';font-size:19pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-4486e994{font-family:'Arial';font-size:19pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 165, 0, 1.00);background-color:transparent;}.cl-4486e995{font-family:'Arial';font-size:19pt;font-weight:normal;font-style:normal;text-decoration:none;background-color:transparent;}.cl-44871052{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4487a670{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a671{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a672{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a673{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a674{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a675{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a676{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a677{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a678{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a679{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487a67a{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd30{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd31{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd32{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd33{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd34{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd35{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd36{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd37{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd38{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd39{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cd3a{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cf9c{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cf9d{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4487cf9e{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}&lt;/style&gt;&lt;table class='cl-449b2eac'&gt;&lt;caption class="Table Caption"&gt;Pearson相关系数矩阵&lt;/caption&gt;&lt;thead&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-4487cd39"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt; &lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cf9e"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;loan.bad&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cf9c"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;loan.surplus&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cf9d"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;loan.receivable&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd3a"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;loan.numbers&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd39"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;investment.fixed&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-4487a670"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;loan.bad&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a673"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a672"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a674"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a671"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a670"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-4487a677"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;loan.surplus&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a676"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e993"&gt;0.8436&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a678"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a679"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a675"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a677"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-4487a67a"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;loan.receivable&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd32"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e994"&gt;0.7315&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd31"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;0.6788&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd30"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd33"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a67a"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-4487a67a"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;loan.numbers&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd32"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e994"&gt;0.7003&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd31"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e993"&gt;0.8484&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd30"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;0.5858&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd33"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487a67a"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e995"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-4487cd35"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;investment.fixed&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd37"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;0.5185&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd34"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e994"&gt;0.7797&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd38"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;0.4724&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd36"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e994"&gt;0.7466&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-4487cd35"&gt;&lt;p class="cl-44871052"&gt;&lt;span class="cl-4486e992"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;/template&gt;
&lt;div class="flextable-shadow-host" id="1f8bf20b-6ad9-4681-8652-6ed422ceb46b"&gt;&lt;/div&gt;
&lt;script&gt;
var dest = document.getElementById("1f8bf20b-6ad9-4681-8652-6ed422ceb46b");
var template = document.getElementById("c78e5334-95bc-4744-8d2d-8f7a602869c5");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
&lt;/script&gt;

---

### （案例）银行贷款：相关系数矩阵(Spearman)


```r
corl_spearman&lt;- round(cor(df_loan[,-1], method = "spearman"),4) 
corl_spearman[upper.tri(corl_spearman)] &lt;- NA
```


&lt;template id="781f79ab-44d7-4b79-bdad-8d6354a20404"&gt;&lt;style&gt;
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
&lt;/style&gt;&lt;div class="tabwid"&gt;&lt;style&gt;.cl-44ee7076{border-collapse:collapse;}.cl-44da910a{font-family:'Arial';font-size:19pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-44da910b{font-family:'Arial';font-size:19pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 0, 0, 1.00);background-color:transparent;}.cl-44da910c{font-family:'Arial';font-size:19pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(255, 165, 0, 1.00);background-color:transparent;}.cl-44da910d{font-family:'Arial';font-size:19pt;font-weight:normal;font-style:normal;text-decoration:none;background-color:transparent;}.cl-44dab5a4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-44db0360{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0361{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0362{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0363{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0364{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0365{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0366{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0367{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0368{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db0369{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db036a{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a66{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a67{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a68{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a69{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a6a{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a6b{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a6c{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a6d{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a6e{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a6f{width:157.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db2a70{width:135.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db5180{width:123pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db5181{width:148.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-44db5182{width:93.4pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}&lt;/style&gt;&lt;table class='cl-44ee7076'&gt;&lt;caption class="Table Caption"&gt;Spearman相关系数矩阵&lt;/caption&gt;&lt;thead&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-44db2a6f"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt; &lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db5182"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;loan.bad&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db5180"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;loan.surplus&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db5181"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;loan.receivable&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a70"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;loan.numbers&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a6f"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;investment.fixed&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-44db0360"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;loan.bad&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0363"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0362"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0364"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0361"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0360"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-44db0367"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;loan.surplus&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0366"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910b"&gt;0.8339&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0368"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0369"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0365"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db0367"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-44db036a"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;loan.receivable&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a68"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910c"&gt;0.7331&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a67"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;0.8148&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a66"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a69"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db036a"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-44db036a"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;loan.numbers&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a68"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910c"&gt;0.7172&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a67"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910b"&gt;0.8559&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a66"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;0.7393&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a69"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db036a"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910d"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style="overflow-wrap:break-word;"&gt;&lt;td class="cl-44db2a6b"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;investment.fixed&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a6d"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;0.4407&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a6a"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910c"&gt;0.6582&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a6e"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;0.5469&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a6c"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910c"&gt;0.5975&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td class="cl-44db2a6b"&gt;&lt;p class="cl-44dab5a4"&gt;&lt;span class="cl-44da910a"&gt;1.0000&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;/template&gt;
&lt;div class="flextable-shadow-host" id="89623331-df54-4693-9fe3-83c18a2eb122"&gt;&lt;/div&gt;
&lt;script&gt;
var dest = document.getElementById("89623331-df54-4693-9fe3-83c18a2eb122");
var template = document.getElementById("781f79ab-44d7-4b79-bdad-8d6354a20404");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
&lt;/script&gt;

---

### （案例）银行贷款：相关系数矩阵图

&lt;img src="05-01-relationship_files/figure-html/unnamed-chunk-37-1.png" width="99%" style="display: block; margin: auto;" /&gt;

???

参考：[Correlation Analysis Different Types of Plots in R](https://finnstats.com/index.php/2021/05/13/correlation-analysis-plot/)

---

### （案例）银行贷款：相关系数矩阵图

&lt;img src="05-01-relationship_files/figure-html/unnamed-chunk-38-1.png" width="99%" style="display: block; margin: auto;" /&gt;


---

### （案例）银行贷款：偏相关系数

假定我们认为不良贷款（`loan.bad`）与贷款余额（`loan.surplus`）及贷款项目数（`loan.number`）存在相互关系。


前面我们已经计算出如下的简单相关系数：
`$$r_{12} = r_{_{bad},_{sur}}= 0.8436; \quad r_{13} = r_{_{bad},_{num}}= 0.7003; \quad r_{23} = r_{_{num},_{sur}}= 0.8484$$`

因此我们可以分别计算出**偏相关系数**

---

### （案例）银行贷款：偏相关系数

- 保持
`\(X_{3i}\)`不变，
`\(Y_i\)`和
`\(X_{2i}\)`之间的相关系数：

`$$\begin {align} 
r_{12 \cdot 3}=\frac{r_{12}-r_{13} r_{23}}{\sqrt{\left(1-r_{13}^{2}\right)\left(1-r_{23}^{2}\right)}}
=\frac{0.84-0.7\times 0.85}{\sqrt{\left(1-0.7^{2}\right)\left(1-0.85^{2}\right)}}
= 0.6601
\end {align}$$`

- 保持
`\(X_{2i}\)`不变，
`\(Y_i\)`和
`\(X_{3i}\)`之间的相关系数：

`$$\begin {align} 
r_{13.2}=\frac{r_{13}-r_{12} r_{23}}{\sqrt{\left(1-r_{12}^{2}\right)\left(1-r_{23}^{2}\right)}} 
=\frac{0.7-0.84 \times 0.85}{\sqrt{\left(1-0.84^{2}\right)\left(1-0.85^{2}\right)}} 
= -0.0542
\end {align}$$`

- 保持
`\(Y_i\)`不变，
`\(X_{2i}\)`和
`\(X_{3i}\)`之间的相关系数：

`$$\begin {align} 
r_{23.1}=\frac{r_{23}-r_{12} r_{13}}{\sqrt{\left(1-r_{12}^{2}\right)\left(1-r_{13}^{2}\right)}}
=\frac{0.85-0.84 \times  0.7}{\sqrt{\left(1-0.84^{2}\right)\left(1-0.7^{2}\right)}} 
= 0.6722
\end {align}$$`


---

### （案例）银行贷款：相关系数显著性检验(手算)

对于前述`loan.surplus`与`loan.bad`进行相关系数显著性检验（Pearson）：

- 1）提出假设：
`\(H_0: \rho =0; H_1: \rho \neq 0\)`

- 2）计算样本统计量：

`$$\begin{align}
T^{\ast} = |r|\sqrt{\frac{n-2}{1-r^2}} 
=0.84 \times \sqrt{\frac{25-2}{1-0.84^2}}
= 7.53
\end{align}$$`

- 3）给定显著性水平
`\(\alpha=0.05\)`，确定t理论分布值
`\(t_{1-\alpha/2}(n-2)=t_{1-0.05/2}(25-2)=t_{0.975}(23)=2.07\)`。

- 4）得到假设检验结论：因为t样本统计量大于t理论查表值，也即

`$$\left[T^{\ast}= 7.53\right] &gt; \left[t_{0.975}(23) =2.07\right]$$`

因此拒绝原假设
`\(H_0\)`，认为变量`loan.surplus`（贷款余额）与`loan.bad`（不良贷款）显著存在相关关系。


---

### （案例）银行贷款：相关系数显著性检验(R软件)

我们可以使用R软件函数`cor.test()`对上述两个变量进行相关系数显著性检验：


```r
cor.test(df_rel1$loan.surplus, df_rel1$loan.bad,
         method = "pearson")
```

```

	Pearson's product-moment correlation

data:  df_rel1$loan.surplus and df_rel1$loan.bad
t = 8, df = 23, p-value = 0.0000001
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.67 0.93
sample estimates:
 cor 
0.84 
```

---
layout:false
background-image: url("../pic/thank-you-gif-funny-little-yellow.gif")
class: inverse,center
# 本节结束
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
